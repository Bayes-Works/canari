

<!DOCTYPE html>
<html class="writer-html5" lang="EN" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>canari &mdash; canari v.0.0.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=d433095d"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Forecasting with Canari" href="../examples/tutorial_forecast.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            canari
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/tutorial_forecast.html">Forecasting with Canari</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Docs</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">canari</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-canari.data_process">Data Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#canari.data_process.DataProcess"><code class="docutils literal notranslate"><span class="pre">DataProcess</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.data_process.DataProcess.add_lagged_columns"><code class="docutils literal notranslate"><span class="pre">DataProcess.add_lagged_columns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.data_process.DataProcess.add_synthetic_anomaly"><code class="docutils literal notranslate"><span class="pre">DataProcess.add_synthetic_anomaly()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.data_process.DataProcess.decompose_data"><code class="docutils literal notranslate"><span class="pre">DataProcess.decompose_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.data_process.DataProcess.get_data"><code class="docutils literal notranslate"><span class="pre">DataProcess.get_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.data_process.DataProcess.get_split_indices"><code class="docutils literal notranslate"><span class="pre">DataProcess.get_split_indices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.data_process.DataProcess.get_splits"><code class="docutils literal notranslate"><span class="pre">DataProcess.get_splits()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.data_process.DataProcess.get_time"><code class="docutils literal notranslate"><span class="pre">DataProcess.get_time()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.data_process.DataProcess.normalize_data"><code class="docutils literal notranslate"><span class="pre">DataProcess.normalize_data()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-canari.component.base_component">Component</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#canari.component.base_component.BaseComponent"><code class="docutils literal notranslate"><span class="pre">BaseComponent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.component_name"><code class="docutils literal notranslate"><span class="pre">BaseComponent.component_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.initialize_component_name"><code class="docutils literal notranslate"><span class="pre">BaseComponent.initialize_component_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.initialize_mu_states"><code class="docutils literal notranslate"><span class="pre">BaseComponent.initialize_mu_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.initialize_num_states"><code class="docutils literal notranslate"><span class="pre">BaseComponent.initialize_num_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.initialize_observation_matrix"><code class="docutils literal notranslate"><span class="pre">BaseComponent.initialize_observation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.initialize_process_noise_matrix"><code class="docutils literal notranslate"><span class="pre">BaseComponent.initialize_process_noise_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.initialize_states_name"><code class="docutils literal notranslate"><span class="pre">BaseComponent.initialize_states_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.initialize_transition_matrix"><code class="docutils literal notranslate"><span class="pre">BaseComponent.initialize_transition_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.initialize_var_states"><code class="docutils literal notranslate"><span class="pre">BaseComponent.initialize_var_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.mu_states"><code class="docutils literal notranslate"><span class="pre">BaseComponent.mu_states</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.num_states"><code class="docutils literal notranslate"><span class="pre">BaseComponent.num_states</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.observation_matrix"><code class="docutils literal notranslate"><span class="pre">BaseComponent.observation_matrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.process_noise_matrix"><code class="docutils literal notranslate"><span class="pre">BaseComponent.process_noise_matrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.states_name"><code class="docutils literal notranslate"><span class="pre">BaseComponent.states_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.transition_matrix"><code class="docutils literal notranslate"><span class="pre">BaseComponent.transition_matrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.base_component.BaseComponent.var_states"><code class="docutils literal notranslate"><span class="pre">BaseComponent.var_states</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#canari.component.autoregression_component.Autoregression"><code class="docutils literal notranslate"><span class="pre">Autoregression</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.autoregression_component.Autoregression.initialize_component_name"><code class="docutils literal notranslate"><span class="pre">Autoregression.initialize_component_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.autoregression_component.Autoregression.initialize_mu_states"><code class="docutils literal notranslate"><span class="pre">Autoregression.initialize_mu_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.autoregression_component.Autoregression.initialize_num_states"><code class="docutils literal notranslate"><span class="pre">Autoregression.initialize_num_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.autoregression_component.Autoregression.initialize_observation_matrix"><code class="docutils literal notranslate"><span class="pre">Autoregression.initialize_observation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.autoregression_component.Autoregression.initialize_process_noise_matrix"><code class="docutils literal notranslate"><span class="pre">Autoregression.initialize_process_noise_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.autoregression_component.Autoregression.initialize_states_name"><code class="docutils literal notranslate"><span class="pre">Autoregression.initialize_states_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.autoregression_component.Autoregression.initialize_transition_matrix"><code class="docutils literal notranslate"><span class="pre">Autoregression.initialize_transition_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.autoregression_component.Autoregression.initialize_var_states"><code class="docutils literal notranslate"><span class="pre">Autoregression.initialize_var_states()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#canari.component.baseline_component.LocalAcceleration"><code class="docutils literal notranslate"><span class="pre">LocalAcceleration</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalAcceleration.initialize_component_name"><code class="docutils literal notranslate"><span class="pre">LocalAcceleration.initialize_component_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalAcceleration.initialize_mu_states"><code class="docutils literal notranslate"><span class="pre">LocalAcceleration.initialize_mu_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalAcceleration.initialize_num_states"><code class="docutils literal notranslate"><span class="pre">LocalAcceleration.initialize_num_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalAcceleration.initialize_observation_matrix"><code class="docutils literal notranslate"><span class="pre">LocalAcceleration.initialize_observation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalAcceleration.initialize_process_noise_matrix"><code class="docutils literal notranslate"><span class="pre">LocalAcceleration.initialize_process_noise_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalAcceleration.initialize_states_name"><code class="docutils literal notranslate"><span class="pre">LocalAcceleration.initialize_states_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalAcceleration.initialize_transition_matrix"><code class="docutils literal notranslate"><span class="pre">LocalAcceleration.initialize_transition_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalAcceleration.initialize_var_states"><code class="docutils literal notranslate"><span class="pre">LocalAcceleration.initialize_var_states()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#canari.component.baseline_component.LocalLevel"><code class="docutils literal notranslate"><span class="pre">LocalLevel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalLevel.initialize_component_name"><code class="docutils literal notranslate"><span class="pre">LocalLevel.initialize_component_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalLevel.initialize_mu_states"><code class="docutils literal notranslate"><span class="pre">LocalLevel.initialize_mu_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalLevel.initialize_num_states"><code class="docutils literal notranslate"><span class="pre">LocalLevel.initialize_num_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalLevel.initialize_observation_matrix"><code class="docutils literal notranslate"><span class="pre">LocalLevel.initialize_observation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalLevel.initialize_process_noise_matrix"><code class="docutils literal notranslate"><span class="pre">LocalLevel.initialize_process_noise_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalLevel.initialize_states_name"><code class="docutils literal notranslate"><span class="pre">LocalLevel.initialize_states_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalLevel.initialize_transition_matrix"><code class="docutils literal notranslate"><span class="pre">LocalLevel.initialize_transition_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalLevel.initialize_var_states"><code class="docutils literal notranslate"><span class="pre">LocalLevel.initialize_var_states()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#canari.component.baseline_component.LocalTrend"><code class="docutils literal notranslate"><span class="pre">LocalTrend</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalTrend.initialize_component_name"><code class="docutils literal notranslate"><span class="pre">LocalTrend.initialize_component_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalTrend.initialize_mu_states"><code class="docutils literal notranslate"><span class="pre">LocalTrend.initialize_mu_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalTrend.initialize_num_states"><code class="docutils literal notranslate"><span class="pre">LocalTrend.initialize_num_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalTrend.initialize_observation_matrix"><code class="docutils literal notranslate"><span class="pre">LocalTrend.initialize_observation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalTrend.initialize_process_noise_matrix"><code class="docutils literal notranslate"><span class="pre">LocalTrend.initialize_process_noise_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalTrend.initialize_states_name"><code class="docutils literal notranslate"><span class="pre">LocalTrend.initialize_states_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalTrend.initialize_transition_matrix"><code class="docutils literal notranslate"><span class="pre">LocalTrend.initialize_transition_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.baseline_component.LocalTrend.initialize_var_states"><code class="docutils literal notranslate"><span class="pre">LocalTrend.initialize_var_states()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#canari.component.periodic_component.Periodic"><code class="docutils literal notranslate"><span class="pre">Periodic</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.periodic_component.Periodic.initialize_component_name"><code class="docutils literal notranslate"><span class="pre">Periodic.initialize_component_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.periodic_component.Periodic.initialize_mu_states"><code class="docutils literal notranslate"><span class="pre">Periodic.initialize_mu_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.periodic_component.Periodic.initialize_num_states"><code class="docutils literal notranslate"><span class="pre">Periodic.initialize_num_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.periodic_component.Periodic.initialize_observation_matrix"><code class="docutils literal notranslate"><span class="pre">Periodic.initialize_observation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.periodic_component.Periodic.initialize_process_noise_matrix"><code class="docutils literal notranslate"><span class="pre">Periodic.initialize_process_noise_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.periodic_component.Periodic.initialize_states_name"><code class="docutils literal notranslate"><span class="pre">Periodic.initialize_states_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.periodic_component.Periodic.initialize_transition_matrix"><code class="docutils literal notranslate"><span class="pre">Periodic.initialize_transition_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.periodic_component.Periodic.initialize_var_states"><code class="docutils literal notranslate"><span class="pre">Periodic.initialize_var_states()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#canari.component.white_noise_component.WhiteNoise"><code class="docutils literal notranslate"><span class="pre">WhiteNoise</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.white_noise_component.WhiteNoise.initialize_component_name"><code class="docutils literal notranslate"><span class="pre">WhiteNoise.initialize_component_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.white_noise_component.WhiteNoise.initialize_mu_states"><code class="docutils literal notranslate"><span class="pre">WhiteNoise.initialize_mu_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.white_noise_component.WhiteNoise.initialize_num_states"><code class="docutils literal notranslate"><span class="pre">WhiteNoise.initialize_num_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.white_noise_component.WhiteNoise.initialize_observation_matrix"><code class="docutils literal notranslate"><span class="pre">WhiteNoise.initialize_observation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.white_noise_component.WhiteNoise.initialize_process_noise_matrix"><code class="docutils literal notranslate"><span class="pre">WhiteNoise.initialize_process_noise_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.white_noise_component.WhiteNoise.initialize_states_name"><code class="docutils literal notranslate"><span class="pre">WhiteNoise.initialize_states_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.white_noise_component.WhiteNoise.initialize_transition_matrix"><code class="docutils literal notranslate"><span class="pre">WhiteNoise.initialize_transition_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.white_noise_component.WhiteNoise.initialize_var_states"><code class="docutils literal notranslate"><span class="pre">WhiteNoise.initialize_var_states()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#canari.component.lstm_component.LstmNetwork"><code class="docutils literal notranslate"><span class="pre">LstmNetwork</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.lstm_component.LstmNetwork.initialize_component_name"><code class="docutils literal notranslate"><span class="pre">LstmNetwork.initialize_component_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.lstm_component.LstmNetwork.initialize_lstm_network"><code class="docutils literal notranslate"><span class="pre">LstmNetwork.initialize_lstm_network()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.lstm_component.LstmNetwork.initialize_mu_states"><code class="docutils literal notranslate"><span class="pre">LstmNetwork.initialize_mu_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.lstm_component.LstmNetwork.initialize_num_states"><code class="docutils literal notranslate"><span class="pre">LstmNetwork.initialize_num_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.lstm_component.LstmNetwork.initialize_observation_matrix"><code class="docutils literal notranslate"><span class="pre">LstmNetwork.initialize_observation_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.lstm_component.LstmNetwork.initialize_process_noise_matrix"><code class="docutils literal notranslate"><span class="pre">LstmNetwork.initialize_process_noise_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.lstm_component.LstmNetwork.initialize_states_name"><code class="docutils literal notranslate"><span class="pre">LstmNetwork.initialize_states_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.lstm_component.LstmNetwork.initialize_transition_matrix"><code class="docutils literal notranslate"><span class="pre">LstmNetwork.initialize_transition_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.component.lstm_component.LstmNetwork.initialize_var_states"><code class="docutils literal notranslate"><span class="pre">LstmNetwork.initialize_var_states()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-canari.model">Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#canari.model.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.components"><code class="docutils literal notranslate"><span class="pre">Model.components</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.states"><code class="docutils literal notranslate"><span class="pre">Model.states</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.lstm_net"><code class="docutils literal notranslate"><span class="pre">Model.lstm_net</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.lstm_output_history"><code class="docutils literal notranslate"><span class="pre">Model.lstm_output_history</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.observation_matrix"><code class="docutils literal notranslate"><span class="pre">Model.observation_matrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.transition_matrix"><code class="docutils literal notranslate"><span class="pre">Model.transition_matrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.process_noise_matrix"><code class="docutils literal notranslate"><span class="pre">Model.process_noise_matrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.auto_initialize_baseline_states"><code class="docutils literal notranslate"><span class="pre">Model.auto_initialize_baseline_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.backward"><code class="docutils literal notranslate"><span class="pre">Model.backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.early_stopping"><code class="docutils literal notranslate"><span class="pre">Model.early_stopping()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.filter"><code class="docutils literal notranslate"><span class="pre">Model.filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.forecast"><code class="docutils literal notranslate"><span class="pre">Model.forecast()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.forward"><code class="docutils literal notranslate"><span class="pre">Model.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.generate_time_series"><code class="docutils literal notranslate"><span class="pre">Model.generate_time_series()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.get_dict"><code class="docutils literal notranslate"><span class="pre">Model.get_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.get_states_index"><code class="docutils literal notranslate"><span class="pre">Model.get_states_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.initialize_states_history"><code class="docutils literal notranslate"><span class="pre">Model.initialize_states_history()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.initialize_states_with_smoother_estimates"><code class="docutils literal notranslate"><span class="pre">Model.initialize_states_with_smoother_estimates()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.load_dict"><code class="docutils literal notranslate"><span class="pre">Model.load_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.lstm_train"><code class="docutils literal notranslate"><span class="pre">Model.lstm_train()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.rts_smoother"><code class="docutils literal notranslate"><span class="pre">Model.rts_smoother()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.set_memory"><code class="docutils literal notranslate"><span class="pre">Model.set_memory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.set_posterior_states"><code class="docutils literal notranslate"><span class="pre">Model.set_posterior_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.set_states"><code class="docutils literal notranslate"><span class="pre">Model.set_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model.Model.smoother"><code class="docutils literal notranslate"><span class="pre">Model.smoother()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-canari.model_optimizer">Model Optimizer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#canari.model_optimizer.CustomLogger"><code class="docutils literal notranslate"><span class="pre">CustomLogger</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.CustomLogger.total_samples"><code class="docutils literal notranslate"><span class="pre">CustomLogger.total_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.CustomLogger.current_sample"><code class="docutils literal notranslate"><span class="pre">CustomLogger.current_sample</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.CustomLogger.trial_sample_map"><code class="docutils literal notranslate"><span class="pre">CustomLogger.trial_sample_map</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.CustomLogger.on_trial_result"><code class="docutils literal notranslate"><span class="pre">CustomLogger.on_trial_result()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer.initialize_model"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.initialize_model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer.train"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.train</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer.param_space"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.param_space</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer.data_processor"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.data_processor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer.num_optimization_trial"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.num_optimization_trial</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer.grid_search"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.grid_search</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer.algorithm"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.algorithm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer.model_optim"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.model_optim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer.param_optim"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.param_optim</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer.get_best_model"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.get_best_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.model_optimizer.ModelOptimizer.optimize"><code class="docutils literal notranslate"><span class="pre">ModelOptimizer.optimize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-canari.SKF">SKF</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#canari.SKF.SKF"><code class="docutils literal notranslate"><span class="pre">SKF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.norm_to_abnorm_prob"><code class="docutils literal notranslate"><span class="pre">SKF.norm_to_abnorm_prob</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.abnorm_to_norm_prob"><code class="docutils literal notranslate"><span class="pre">SKF.abnorm_to_norm_prob</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.norm_model_prior_prob"><code class="docutils literal notranslate"><span class="pre">SKF.norm_model_prior_prob</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.model"><code class="docutils literal notranslate"><span class="pre">SKF.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.states"><code class="docutils literal notranslate"><span class="pre">SKF.states</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.transition_coef"><code class="docutils literal notranslate"><span class="pre">SKF.transition_coef</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.auto_initialize_baseline_states"><code class="docutils literal notranslate"><span class="pre">SKF.auto_initialize_baseline_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.backward"><code class="docutils literal notranslate"><span class="pre">SKF.backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.detect_synthetic_anomaly"><code class="docutils literal notranslate"><span class="pre">SKF.detect_synthetic_anomaly()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.early_stopping"><code class="docutils literal notranslate"><span class="pre">SKF.early_stopping()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.filter"><code class="docutils literal notranslate"><span class="pre">SKF.filter()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.forward"><code class="docutils literal notranslate"><span class="pre">SKF.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.get_dict"><code class="docutils literal notranslate"><span class="pre">SKF.get_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.initialize_states_history"><code class="docutils literal notranslate"><span class="pre">SKF.initialize_states_history()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.load_dict"><code class="docutils literal notranslate"><span class="pre">SKF.load_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.load_initial_states"><code class="docutils literal notranslate"><span class="pre">SKF.load_initial_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.lstm_train"><code class="docutils literal notranslate"><span class="pre">SKF.lstm_train()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.marginal"><code class="docutils literal notranslate"><span class="pre">SKF.marginal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.prob_history"><code class="docutils literal notranslate"><span class="pre">SKF.prob_history()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.rts_smoother"><code class="docutils literal notranslate"><span class="pre">SKF.rts_smoother()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.save_initial_states"><code class="docutils literal notranslate"><span class="pre">SKF.save_initial_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.set_memory"><code class="docutils literal notranslate"><span class="pre">SKF.set_memory()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.set_same_states_transition_models"><code class="docutils literal notranslate"><span class="pre">SKF.set_same_states_transition_models()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.set_states"><code class="docutils literal notranslate"><span class="pre">SKF.set_states()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.smoother"><code class="docutils literal notranslate"><span class="pre">SKF.smoother()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF.SKF.transition"><code class="docutils literal notranslate"><span class="pre">SKF.transition()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-canari.SKF_optimizer">SKF Optimizer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#canari.SKF_optimizer.CustomLogger"><code class="docutils literal notranslate"><span class="pre">CustomLogger</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF_optimizer.CustomLogger.on_trial_result"><code class="docutils literal notranslate"><span class="pre">CustomLogger.on_trial_result()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#canari.SKF_optimizer.SKFOptimizer"><code class="docutils literal notranslate"><span class="pre">SKFOptimizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF_optimizer.SKFOptimizer.get_best_model"><code class="docutils literal notranslate"><span class="pre">SKFOptimizer.get_best_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.SKF_optimizer.SKFOptimizer.optimize"><code class="docutils literal notranslate"><span class="pre">SKFOptimizer.optimize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-canari.common">Common functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#canari.common.GMA"><code class="docutils literal notranslate"><span class="pre">GMA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#canari.common.GMA.mu"><code class="docutils literal notranslate"><span class="pre">GMA.mu</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.common.GMA.var"><code class="docutils literal notranslate"><span class="pre">GMA.var</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.common.GMA.delete"><code class="docutils literal notranslate"><span class="pre">GMA.delete()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.common.GMA.get_results"><code class="docutils literal notranslate"><span class="pre">GMA.get_results()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.common.GMA.multiply_and_augment"><code class="docutils literal notranslate"><span class="pre">GMA.multiply_and_augment()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#canari.common.GMA.swap"><code class="docutils literal notranslate"><span class="pre">GMA.swap()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#canari.common.backward"><code class="docutils literal notranslate"><span class="pre">backward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.common.calc_observation"><code class="docutils literal notranslate"><span class="pre">calc_observation()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.common.create_block_diag"><code class="docutils literal notranslate"><span class="pre">create_block_diag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.common.forward"><code class="docutils literal notranslate"><span class="pre">forward()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.common.gaussian_mixture"><code class="docutils literal notranslate"><span class="pre">gaussian_mixture()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.common.pad_matrix"><code class="docutils literal notranslate"><span class="pre">pad_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.common.prepare_lstm_input"><code class="docutils literal notranslate"><span class="pre">prepare_lstm_input()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.common.rts_smoother"><code class="docutils literal notranslate"><span class="pre">rts_smoother()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.common.unstandardize_states"><code class="docutils literal notranslate"><span class="pre">unstandardize_states()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-canari.data_visualization">Data Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#canari.data_visualization.plot_data"><code class="docutils literal notranslate"><span class="pre">plot_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.data_visualization.plot_prediction"><code class="docutils literal notranslate"><span class="pre">plot_prediction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.data_visualization.plot_skf_states"><code class="docutils literal notranslate"><span class="pre">plot_skf_states()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.data_visualization.plot_states"><code class="docutils literal notranslate"><span class="pre">plot_states()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#canari.data_visualization.plot_with_uncertainty"><code class="docutils literal notranslate"><span class="pre">plot_with_uncertainty()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">canari</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">canari</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/canari.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="canari">
<h1>canari<a class="headerlink" href="#canari" title="Link to this heading"></a></h1>
<section id="module-canari.data_process">
<span id="data-process"></span><h2>Data Process<a class="headerlink" href="#module-canari.data_process" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="canari.data_process.DataProcess">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.data_process.</span></span><span class="sig-name descname"><span class="pre">DataProcess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_covariates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[0]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/data_process.html#DataProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_process.DataProcess" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Data processing for time series.</p>
<p>This module provides the <cite>DataProcess</cite> class to facilitate:</p>
<ul class="simple">
<li><p>Standardize datasets based on training statistics</p></li>
<li><p>Split data into training, validation, and test sets</p></li>
<li><p>Add time covariates (hour, day, month, etc.) to data</p></li>
<li><p>Generate lagged versions of features</p></li>
<li><p>Add synthetic anomalies to data</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – Input DataFrame with a datetime or numeric index.</p></li>
<li><p><strong>train_start</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Start index for training set.</p></li>
<li><p><strong>train_end</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – End index for training set.</p></li>
<li><p><strong>validation_start</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Start index for validation set.</p></li>
<li><p><strong>validation_end</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – End index for validation set.</p></li>
<li><p><strong>test_start</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – Start index for test set.</p></li>
<li><p><strong>test_end</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em>) – End index for test set.</p></li>
<li><p><strong>train_split</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Proportion of data for training set.</p></li>
<li><p><strong>validation_split</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Proportion for validation set.</p></li>
<li><p><strong>test_split</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Proportion for test set.</p></li>
<li><p><strong>time_covariates</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em>) – Time covariates added to dataset</p></li>
<li><p><strong>output_col</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Column’s indice for target variable.</p></li>
<li><p><strong>normalization</strong> (<em>Optional</em><em>[</em><em>bool</em><em>]</em>) – Whether to apply data standardization
(zero mean, unit standard deviation).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">canari</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataProcess</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dt_index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="s2">&quot;2025-01-01&quot;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mi">11</span><span class="p">)},</span>
<span class="go">                        index=dt_index)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp</span> <span class="o">=</span> <span class="n">DataProcess</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
<span class="go">                    train_split=0.7,</span>
<span class="go">                    validation_split=0.2,</span>
<span class="go">                    test_split=0.1,</span>
<span class="go">                    time_covariates = [&quot;hour_of_day&quot;],</span>
<span class="go">                    normalization=True,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="canari.data_process.DataProcess.add_lagged_columns">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_lagged_columns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lags_per_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">DataFrame</span></span></span><a class="reference internal" href="../_modules/canari/data_process.html#DataProcess.add_lagged_columns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_process.DataProcess.add_lagged_columns" title="Link to this definition"></a></dt>
<dd><p>Add lagged versions of each column in the dataset, then add to the dataset as
new columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pd.DataFrame</em>) – Input DataFrame with datetime index.</p></li>
<li><p><strong>lags_per_column</strong> (<em>list</em><em>[</em><em>int</em><em>]</em>) – Number of lags per column.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New DataFrame with lagged columns.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data_lag</span> <span class="o">=</span> <span class="n">DataProcess</span><span class="o">.</span><span class="n">add_lagged_columns</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.data_process.DataProcess.add_synthetic_anomaly">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">add_synthetic_anomaly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.66</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/data_process.html#DataProcess.add_synthetic_anomaly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_process.DataProcess.add_synthetic_anomaly" title="Link to this definition"></a></dt>
<dd><p># TODO
Add synthetic anomalies randomly to a train, validation, or test sets.
From the orginal data, choose a window between <cite>anomaly_start</cite> and <cite>anomaly_end</cite> (ratio: 0-1).
Following a uniform distribution, randomly choose in this window where the anomaly starts.
Data after the anomaly start is shifted a by <cite>slope</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>dict</em>) – Data dict with “x” and “y”.</p></li>
<li><p><strong>num_samples</strong> (<em>int</em>) – Number of anomaly to generate.</p></li>
<li><p><strong>slope</strong> (<em>list</em><em>[</em><em>float</em><em>]</em>) – Slope for anomaly.</p></li>
<li><p><strong>anomaly_start</strong> (<em>float</em>) – Start of anomaly window (0–1).</p></li>
<li><p><strong>anomaly_end</strong> (<em>float</em>) – End of anomaly window (0–1).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Data dicts with anomalies injected.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">train_set</span><span class="p">,</span> <span class="n">val_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">all_data</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">get_splits</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train_set_with_anomaly</span> <span class="o">=</span> <span class="n">DataProcess</span><span class="o">.</span><span class="n">add_synthetic_anomaly</span><span class="p">(</span>
<span class="go">                                train_set,</span>
<span class="go">                                num_samples=2,</span>
<span class="go">                                slope=[0.01, 0.1],</span>
<span class="go">                            )</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.data_process.DataProcess.decompose_data">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">decompose_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/data_process.html#DataProcess.decompose_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_process.DataProcess.decompose_data" title="Link to this definition"></a></dt>
<dd><p>Decompose a time series into a linear trend, seasonality, and residual
using Fourier transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>np.ndarray</em>) – 1D array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(trend, slope_of_trend, seasonality, residual)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">train_set</span><span class="p">,</span> <span class="n">val_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">all_data</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">get_splits</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dp</span> <span class="o">=</span> <span class="n">DataProcess</span><span class="o">.</span><span class="n">decompose_data</span><span class="p">(</span><span class="n">train_set</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.data_process.DataProcess.get_data">
<span class="sig-name descname"><span class="pre">get_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/canari/data_process.html#DataProcess.get_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_process.DataProcess.get_data" title="Link to this definition"></a></dt>
<dd><p>Return a specific column’s values for a given data split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split</strong> (<em>str</em>) – One of [‘train’, ‘validation’, ‘test’, ‘all’].</p></li>
<li><p><strong>normalization</strong> (<em>bool</em>) – Whether to normalize the output.</p></li>
<li><p><strong>column</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Column index.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The extracted values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">get_data</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">,</span> <span class="n">normalization</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.data_process.DataProcess.get_split_indices">
<span class="sig-name descname"><span class="pre">get_split_indices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">array</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/data_process.html#DataProcess.get_split_indices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_process.DataProcess.get_split_indices" title="Link to this definition"></a></dt>
<dd><p>Get the index ranges for the train, validation, and test splits.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Train, validation, and test indices.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[np.array, np.array, np.array]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">train_index</span><span class="p">,</span> <span class="n">val_index</span><span class="p">,</span> <span class="n">test_index</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">get_split_indices</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.data_process.DataProcess.get_splits">
<span class="sig-name descname"><span class="pre">get_splits</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/data_process.html#DataProcess.get_splits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_process.DataProcess.get_splits" title="Link to this definition"></a></dt>
<dd><p>Retrieve the input, output pairs (x, y) for train, validation, test sets, and all data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple of dictionaries, each with keys “x” and “y”.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">train_set</span><span class="p">,</span> <span class="n">val_set</span><span class="p">,</span> <span class="n">test_set</span><span class="p">,</span> <span class="n">all_data</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">get_splits</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.data_process.DataProcess.get_time">
<span class="sig-name descname"><span class="pre">get_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">split</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/canari/data_process.html#DataProcess.get_time"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_process.DataProcess.get_time" title="Link to this definition"></a></dt>
<dd><p>Get datetime indices corresponding to a given split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>split</strong> (<em>str</em>) – One of [‘train’, ‘validation’, ‘test’, ‘all’].</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of timestamps.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">dp</span><span class="o">.</span><span class="n">get_time</span><span class="p">(</span><span class="n">split</span><span class="o">=</span><span class="s2">&quot;train&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.data_process.DataProcess.normalize_data">
<span class="sig-name descname"><span class="pre">normalize_data</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/canari/data_process.html#DataProcess.normalize_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_process.DataProcess.normalize_data" title="Link to this definition"></a></dt>
<dd><p>TODO: unnomalize data method
Normalize the data using training statistics.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Normalized dataset.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-canari.component.base_component">
<span id="component"></span><h2>Component<a class="headerlink" href="#module-canari.component.base_component" title="Link to this heading"></a></h2>
<p>BaseComponent for Canari</p>
<p>This module defines the <cite>BaseComponent</cite> abstract class. It defines the required
structure for any Canari’s component.</p>
<p>Subclasses must implement all abstract methods.</p>
<dl class="py class">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.component.base_component.</span></span><span class="sig-name descname"><span class="pre">BaseComponent</span></span><a class="reference internal" href="../_modules/canari/component/base_component.html#BaseComponent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.base_component.BaseComponent" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></p>
<p>Abstract base class for all Canari’s components.</p>
<p>This class defines the interface and shared attributes for all components.</p>
<p>Examples:</p>
<dl class="py property">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.component_name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">component_name</span></span><a class="headerlink" href="#canari.component.base_component.BaseComponent.component_name" title="Link to this definition"></a></dt>
<dd><p>Name of the component.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.initialize_component_name">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_component_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/base_component.html#BaseComponent.initialize_component_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.base_component.BaseComponent.initialize_component_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the component’s name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.initialize_mu_states">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_mu_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/base_component.html#BaseComponent.initialize_mu_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.base_component.BaseComponent.initialize_mu_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the mean of the hidden states.
Must define or validate the initial <cite>mu_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.initialize_num_states">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_num_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/base_component.html#BaseComponent.initialize_num_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.base_component.BaseComponent.initialize_num_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the number of hidden states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.initialize_observation_matrix">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_observation_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/base_component.html#BaseComponent.initialize_observation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.base_component.BaseComponent.initialize_observation_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the observation matrix.
Must define <cite>self._observation_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.initialize_process_noise_matrix">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_process_noise_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/base_component.html#BaseComponent.initialize_process_noise_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.base_component.BaseComponent.initialize_process_noise_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the process noise covariance matrix.
Must define <cite>self._process_noise_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.initialize_states_name">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_states_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/base_component.html#BaseComponent.initialize_states_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.base_component.BaseComponent.initialize_states_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the names of all hidden states.
Must provide <cite>self._states_name</cite> with a list of strings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.initialize_transition_matrix">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_transition_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/base_component.html#BaseComponent.initialize_transition_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.base_component.BaseComponent.initialize_transition_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the transition matrix.
Must define <cite>self._transition_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.initialize_var_states">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">initialize_var_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/base_component.html#BaseComponent.initialize_var_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.base_component.BaseComponent.initialize_var_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the variance of the hidden states.
Must define or validate the initial <cite>var_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.mu_states">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">mu_states</span></span><a class="headerlink" href="#canari.component.base_component.BaseComponent.mu_states" title="Link to this definition"></a></dt>
<dd><p>mean values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.num_states">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_states</span></span><a class="headerlink" href="#canari.component.base_component.BaseComponent.num_states" title="Link to this definition"></a></dt>
<dd><p>Number of hidden states in the component.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.observation_matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_matrix</span></span><a class="headerlink" href="#canari.component.base_component.BaseComponent.observation_matrix" title="Link to this definition"></a></dt>
<dd><p>Observation matrix for the component.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.process_noise_matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">process_noise_matrix</span></span><a class="headerlink" href="#canari.component.base_component.BaseComponent.process_noise_matrix" title="Link to this definition"></a></dt>
<dd><p>Process noise covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.states_name">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">states_name</span></span><a class="headerlink" href="#canari.component.base_component.BaseComponent.states_name" title="Link to this definition"></a></dt>
<dd><p>Names of each hidden state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[str]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.transition_matrix">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transition_matrix</span></span><a class="headerlink" href="#canari.component.base_component.BaseComponent.transition_matrix" title="Link to this definition"></a></dt>
<dd><p>Transition matrix for the component.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="canari.component.base_component.BaseComponent.var_states">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">var_states</span></span><a class="headerlink" href="#canari.component.base_component.BaseComponent.var_states" title="Link to this definition"></a></dt>
<dd><p>covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<p id="module-canari.component.autoregression_component">Autoregression Component for Canari</p>
<p>This module defines an <cite>Autoregression</cite> class, inheriting from Canari’s <cite>BaseComponent</cite>.
It represents residuals following a univariate AR(1) process with optional learning of
the autoregressive coefficient (<cite>phi</cite>) and process noise standard deviation (<cite>std_error</cite>).</p>
<dl class="py class">
<dt class="sig sig-object py" id="canari.component.autoregression_component.Autoregression">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.component.autoregression_component.</span></span><span class="sig-name descname"><span class="pre">Autoregression</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/autoregression_component.html#Autoregression"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.autoregression_component.Autoregression" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#canari.component.base_component.BaseComponent" title="canari.component.base_component.BaseComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseComponent</span></code></a></p>
<p>Autoregression component for modeling residual following a univariate AR(1) process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>std_error</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Known standard deviation of the process noise. If None, it will be learned using AGVI.</p></li>
<li><p><strong>phi</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Known autoregressive coefficient. If None, it will be learned using Gaussian Multiplicative Approximation (GMA).</p></li>
<li><p><strong>mu_states</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Initial mean values.</p></li>
<li><p><strong>var_states</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Initial covariance matrix.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Behavior:</dt><dd><ul class="simple">
<li><p>Adds 2 extra states if <cite>phi</cite> is None.</p></li>
<li><p>Adds 3 extra states if <cite>std_error</cite> is None.</p></li>
<li><p>Initializes transition, observation, and noise matrices accordingly.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If dimensions of <cite>mu_states</cite> or <cite>var_states</cite> do not match expected number of states.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">my_module.autoregression</span><span class="w"> </span><span class="kn">import</span> <span class="n">Autoregression</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="n">Autoregression</span><span class="p">(</span><span class="n">std_error</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">phi</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ar</span><span class="o">.</span><span class="n">mu_states</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ar</span><span class="o">.</span><span class="n">var_states</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ar</span><span class="o">.</span><span class="n">states_name</span><span class="p">)</span>
<span class="go">[&#39;autoregression&#39;, &#39;phi&#39;, &#39;phi_autoregression&#39;, &#39;AR_error&#39;, &#39;W2&#39;, &#39;W2bar&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="n">Autoregression</span><span class="p">(</span><span class="n">phi</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">std_error</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ar</span> <span class="o">=</span> <span class="n">Autoregression</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="canari.component.autoregression_component.Autoregression.initialize_component_name">
<span class="sig-name descname"><span class="pre">initialize_component_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/autoregression_component.html#Autoregression.initialize_component_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.autoregression_component.Autoregression.initialize_component_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the component’s name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.autoregression_component.Autoregression.initialize_mu_states">
<span class="sig-name descname"><span class="pre">initialize_mu_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/autoregression_component.html#Autoregression.initialize_mu_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.autoregression_component.Autoregression.initialize_mu_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the mean of the hidden states.
Must define or validate the initial <cite>mu_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.autoregression_component.Autoregression.initialize_num_states">
<span class="sig-name descname"><span class="pre">initialize_num_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/autoregression_component.html#Autoregression.initialize_num_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.autoregression_component.Autoregression.initialize_num_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the number of hidden states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.autoregression_component.Autoregression.initialize_observation_matrix">
<span class="sig-name descname"><span class="pre">initialize_observation_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/autoregression_component.html#Autoregression.initialize_observation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.autoregression_component.Autoregression.initialize_observation_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the observation matrix.
Must define <cite>self._observation_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.autoregression_component.Autoregression.initialize_process_noise_matrix">
<span class="sig-name descname"><span class="pre">initialize_process_noise_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/autoregression_component.html#Autoregression.initialize_process_noise_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.autoregression_component.Autoregression.initialize_process_noise_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the process noise covariance matrix.
Must define <cite>self._process_noise_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.autoregression_component.Autoregression.initialize_states_name">
<span class="sig-name descname"><span class="pre">initialize_states_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/autoregression_component.html#Autoregression.initialize_states_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.autoregression_component.Autoregression.initialize_states_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the names of all hidden states.
Must provide <cite>self._states_name</cite> with a list of strings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.autoregression_component.Autoregression.initialize_transition_matrix">
<span class="sig-name descname"><span class="pre">initialize_transition_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/autoregression_component.html#Autoregression.initialize_transition_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.autoregression_component.Autoregression.initialize_transition_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the transition matrix.
Must define <cite>self._transition_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.autoregression_component.Autoregression.initialize_var_states">
<span class="sig-name descname"><span class="pre">initialize_var_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/autoregression_component.html#Autoregression.initialize_var_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.autoregression_component.Autoregression.initialize_var_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the variance of the hidden states.
Must define or validate the initial <cite>var_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

</dd></dl>

<p id="module-canari.component.baseline_component">Baseline components for Canari</p>
<p>This module defines three state-space components for modeling local level,
local trend, and local acceleration dynamics. Each class inherits from <cite>BaseComponent</cite>.</p>
<dl class="py class">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalAcceleration">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.component.baseline_component.</span></span><span class="sig-name descname"><span class="pre">LocalAcceleration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalAcceleration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalAcceleration" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#canari.component.base_component.BaseComponent" title="canari.component.base_component.BaseComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseComponent</span></code></a></p>
<p>Local acceleration component for modeling baselines with a constant acceleration over time.
This component models three hidden states: level, slope, and acceleration in order to capture a curvature baseline.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>std_error</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Process noise standard deviation. Default is 0.0.</p></li>
<li><p><strong>mu_states</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Initial mean values.</p></li>
<li><p><strong>var_states</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Initial covariance matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If dimensions of <cite>mu_states</cite> or <cite>var_states</cite> do not match expected number of states.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">acc</span> <span class="o">=</span> <span class="n">LocalAcceleration</span><span class="p">(</span><span class="n">std_error</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">acc</span><span class="o">.</span><span class="n">transition_matrix</span>
<span class="go">array([[1. , 1. , 0.5],</span>
<span class="go">       [0. , 1. , 1. ],</span>
<span class="go">       [0. , 0. , 1. ]])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalAcceleration.initialize_component_name">
<span class="sig-name descname"><span class="pre">initialize_component_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalAcceleration.initialize_component_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalAcceleration.initialize_component_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the component’s name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalAcceleration.initialize_mu_states">
<span class="sig-name descname"><span class="pre">initialize_mu_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalAcceleration.initialize_mu_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalAcceleration.initialize_mu_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the mean of the hidden states.
Must define or validate the initial <cite>mu_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalAcceleration.initialize_num_states">
<span class="sig-name descname"><span class="pre">initialize_num_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalAcceleration.initialize_num_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalAcceleration.initialize_num_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the number of hidden states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalAcceleration.initialize_observation_matrix">
<span class="sig-name descname"><span class="pre">initialize_observation_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalAcceleration.initialize_observation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalAcceleration.initialize_observation_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the observation matrix.
Must define <cite>self._observation_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalAcceleration.initialize_process_noise_matrix">
<span class="sig-name descname"><span class="pre">initialize_process_noise_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalAcceleration.initialize_process_noise_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalAcceleration.initialize_process_noise_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the process noise covariance matrix.
Must define <cite>self._process_noise_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalAcceleration.initialize_states_name">
<span class="sig-name descname"><span class="pre">initialize_states_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalAcceleration.initialize_states_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalAcceleration.initialize_states_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the names of all hidden states.
Must provide <cite>self._states_name</cite> with a list of strings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalAcceleration.initialize_transition_matrix">
<span class="sig-name descname"><span class="pre">initialize_transition_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalAcceleration.initialize_transition_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalAcceleration.initialize_transition_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the transition matrix.
Must define <cite>self._transition_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalAcceleration.initialize_var_states">
<span class="sig-name descname"><span class="pre">initialize_var_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalAcceleration.initialize_var_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalAcceleration.initialize_var_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the variance of the hidden states.
Must define or validate the initial <cite>var_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalLevel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.component.baseline_component.</span></span><span class="sig-name descname"><span class="pre">LocalLevel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalLevel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalLevel" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#canari.component.base_component.BaseComponent" title="canari.component.base_component.BaseComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseComponent</span></code></a></p>
<p>Local level component for modeling baselines with a constant level over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>std_error</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Process noise standard deviation. Default is 0.0.</p></li>
<li><p><strong>mu_states</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Initial mean values.</p></li>
<li><p><strong>var_states</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Initial covariance matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If dimensions of <cite>mu_states</cite> or <cite>var_states</cite> do not match expected number of states.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">level</span> <span class="o">=</span> <span class="n">LocalLevel</span><span class="p">(</span><span class="n">std_error</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">level</span><span class="o">.</span><span class="n">component_name</span><span class="p">)</span>
<span class="go">local level</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">level</span><span class="o">.</span><span class="n">transition_matrix</span>
<span class="go">array([[1]])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalLevel.initialize_component_name">
<span class="sig-name descname"><span class="pre">initialize_component_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalLevel.initialize_component_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalLevel.initialize_component_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the component’s name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalLevel.initialize_mu_states">
<span class="sig-name descname"><span class="pre">initialize_mu_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalLevel.initialize_mu_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalLevel.initialize_mu_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the mean of the hidden states.
Must define or validate the initial <cite>mu_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalLevel.initialize_num_states">
<span class="sig-name descname"><span class="pre">initialize_num_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalLevel.initialize_num_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalLevel.initialize_num_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the number of hidden states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalLevel.initialize_observation_matrix">
<span class="sig-name descname"><span class="pre">initialize_observation_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalLevel.initialize_observation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalLevel.initialize_observation_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the observation matrix.
Must define <cite>self._observation_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalLevel.initialize_process_noise_matrix">
<span class="sig-name descname"><span class="pre">initialize_process_noise_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalLevel.initialize_process_noise_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalLevel.initialize_process_noise_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the process noise covariance matrix.
Must define <cite>self._process_noise_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalLevel.initialize_states_name">
<span class="sig-name descname"><span class="pre">initialize_states_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalLevel.initialize_states_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalLevel.initialize_states_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the names of all hidden states.
Must provide <cite>self._states_name</cite> with a list of strings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalLevel.initialize_transition_matrix">
<span class="sig-name descname"><span class="pre">initialize_transition_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalLevel.initialize_transition_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalLevel.initialize_transition_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the transition matrix.
Must define <cite>self._transition_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalLevel.initialize_var_states">
<span class="sig-name descname"><span class="pre">initialize_var_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalLevel.initialize_var_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalLevel.initialize_var_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the variance of the hidden states.
Must define or validate the initial <cite>var_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalTrend">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.component.baseline_component.</span></span><span class="sig-name descname"><span class="pre">LocalTrend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalTrend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalTrend" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#canari.component.base_component.BaseComponent" title="canari.component.base_component.BaseComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseComponent</span></code></a></p>
<p>Local trend component for modeling baselines with a constant speed over time.
This component captures a latent linear trend with both intercept and slope terms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>std_error</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Process noise standard deviation. Default is 0.0.</p></li>
<li><p><strong>mu_states</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Initial mean values.</p></li>
<li><p><strong>var_states</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Initial covariance matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If dimensions of <cite>mu_states</cite> or <cite>var_states</cite> do not match expected number of states.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trend</span> <span class="o">=</span> <span class="n">LocalTrend</span><span class="p">(</span><span class="n">std_error</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trend</span><span class="o">.</span><span class="n">states_name</span>
<span class="go">[&#39;local level&#39;, &#39;local trend&#39;]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalTrend.initialize_component_name">
<span class="sig-name descname"><span class="pre">initialize_component_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalTrend.initialize_component_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalTrend.initialize_component_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the component’s name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalTrend.initialize_mu_states">
<span class="sig-name descname"><span class="pre">initialize_mu_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalTrend.initialize_mu_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalTrend.initialize_mu_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the mean of the hidden states.
Must define or validate the initial <cite>mu_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalTrend.initialize_num_states">
<span class="sig-name descname"><span class="pre">initialize_num_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalTrend.initialize_num_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalTrend.initialize_num_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the number of hidden states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalTrend.initialize_observation_matrix">
<span class="sig-name descname"><span class="pre">initialize_observation_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalTrend.initialize_observation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalTrend.initialize_observation_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the observation matrix.
Must define <cite>self._observation_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalTrend.initialize_process_noise_matrix">
<span class="sig-name descname"><span class="pre">initialize_process_noise_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalTrend.initialize_process_noise_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalTrend.initialize_process_noise_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the process noise covariance matrix.
Must define <cite>self._process_noise_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalTrend.initialize_states_name">
<span class="sig-name descname"><span class="pre">initialize_states_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalTrend.initialize_states_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalTrend.initialize_states_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the names of all hidden states.
Must provide <cite>self._states_name</cite> with a list of strings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalTrend.initialize_transition_matrix">
<span class="sig-name descname"><span class="pre">initialize_transition_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalTrend.initialize_transition_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalTrend.initialize_transition_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the transition matrix.
Must define <cite>self._transition_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.baseline_component.LocalTrend.initialize_var_states">
<span class="sig-name descname"><span class="pre">initialize_var_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/baseline_component.html#LocalTrend.initialize_var_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.baseline_component.LocalTrend.initialize_var_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the variance of the hidden states.
Must define or validate the initial <cite>var_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

</dd></dl>

<p id="module-canari.component.periodic_component">Periodic Component for Canari</p>
<p>This module defines the <cite>Periodic</cite> component, which models a cyclic behavior using
a second-order harmonic state-space model. It inherits from <cite>BaseComponent</cite> and sets
up sinusoidal transitions with a fixed period.</p>
<dl class="py class">
<dt class="sig sig-object py" id="canari.component.periodic_component.Periodic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.component.periodic_component.</span></span><span class="sig-name descname"><span class="pre">Periodic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/periodic_component.html#Periodic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.periodic_component.Periodic" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#canari.component.base_component.BaseComponent" title="canari.component.base_component.BaseComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseComponent</span></code></a></p>
<p>Periodic component for modeling cyclic behavior with a fixed period.</p>
<p>The periodic component represents a two-dimensional latent process with fixed
frequency determined by the <cite>period</cite>. This is useful for capturing seasonality
or other repeating phenomena.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>std_error</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Process noise standard deviation. Default is 0.0.</p></li>
<li><p><strong>period</strong> (<em>float</em>) – Length of one full cycle of the periodic component.</p></li>
<li><p><strong>mu_states</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Initial mean values.</p></li>
<li><p><strong>var_states</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Initial covariance matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the shape of <cite>mu_states</cite> or <cite>var_states</cite> does not match the number of states.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Periodic</span><span class="p">(</span><span class="n">std_error</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">period</span><span class="o">=</span><span class="mi">52</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">states_name</span>
<span class="go">[&#39;periodic 1&#39;, &#39;periodic 2&#39;]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="canari.component.periodic_component.Periodic.initialize_component_name">
<span class="sig-name descname"><span class="pre">initialize_component_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/periodic_component.html#Periodic.initialize_component_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.periodic_component.Periodic.initialize_component_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the component’s name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.periodic_component.Periodic.initialize_mu_states">
<span class="sig-name descname"><span class="pre">initialize_mu_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/periodic_component.html#Periodic.initialize_mu_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.periodic_component.Periodic.initialize_mu_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the mean of the hidden states.
Must define or validate the initial <cite>mu_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.periodic_component.Periodic.initialize_num_states">
<span class="sig-name descname"><span class="pre">initialize_num_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/periodic_component.html#Periodic.initialize_num_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.periodic_component.Periodic.initialize_num_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the number of hidden states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.periodic_component.Periodic.initialize_observation_matrix">
<span class="sig-name descname"><span class="pre">initialize_observation_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/periodic_component.html#Periodic.initialize_observation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.periodic_component.Periodic.initialize_observation_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the observation matrix.
Must define <cite>self._observation_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.periodic_component.Periodic.initialize_process_noise_matrix">
<span class="sig-name descname"><span class="pre">initialize_process_noise_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/periodic_component.html#Periodic.initialize_process_noise_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.periodic_component.Periodic.initialize_process_noise_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the process noise covariance matrix.
Must define <cite>self._process_noise_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.periodic_component.Periodic.initialize_states_name">
<span class="sig-name descname"><span class="pre">initialize_states_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/periodic_component.html#Periodic.initialize_states_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.periodic_component.Periodic.initialize_states_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the names of all hidden states.
Must provide <cite>self._states_name</cite> with a list of strings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.periodic_component.Periodic.initialize_transition_matrix">
<span class="sig-name descname"><span class="pre">initialize_transition_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/periodic_component.html#Periodic.initialize_transition_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.periodic_component.Periodic.initialize_transition_matrix" title="Link to this definition"></a></dt>
<dd><p>Initializes the transition matrix to represent circular rotation dynamics.</p>
<dl class="simple">
<dt>This corresponds to:</dt><dd><dl class="simple">
<dt>[[cos(w), sin(w)],</dt><dd><p>[-sin(w), cos(w)]]</p>
</dd>
</dl>
</dd>
</dl>
<p>where w = 2π / period</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.periodic_component.Periodic.initialize_var_states">
<span class="sig-name descname"><span class="pre">initialize_var_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/periodic_component.html#Periodic.initialize_var_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.periodic_component.Periodic.initialize_var_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the variance of the hidden states.
Must define or validate the initial <cite>var_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

</dd></dl>

<p id="module-canari.component.white_noise_component">White Noise Component for Canari</p>
<p>This module defines the <cite>WhiteNoise</cite> component, a special case of a state-space model
with no dynamics. It captures uncorrelated, zero-mean Gaussian errors as a latent process.</p>
<dl class="py class">
<dt class="sig sig-object py" id="canari.component.white_noise_component.WhiteNoise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.component.white_noise_component.</span></span><span class="sig-name descname"><span class="pre">WhiteNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/white_noise_component.html#WhiteNoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.white_noise_component.WhiteNoise" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#canari.component.base_component.BaseComponent" title="canari.component.base_component.BaseComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseComponent</span></code></a></p>
<p>White noise component for modeling i.i.d. Gaussian process errors.</p>
<p>This component represents a latent variable that has no memory or autoregression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>std_error</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Standard deviation of the white noise process. Default is 0.0.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">wn</span> <span class="o">=</span> <span class="n">WhiteNoise</span><span class="p">(</span><span class="n">std_error</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wn</span><span class="o">.</span><span class="n">transition_matrix</span>
<span class="go">array([[0]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wn</span><span class="o">.</span><span class="n">process_noise_matrix</span>
<span class="go">array([[0.25]])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="canari.component.white_noise_component.WhiteNoise.initialize_component_name">
<span class="sig-name descname"><span class="pre">initialize_component_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/white_noise_component.html#WhiteNoise.initialize_component_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.white_noise_component.WhiteNoise.initialize_component_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the component’s name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.white_noise_component.WhiteNoise.initialize_mu_states">
<span class="sig-name descname"><span class="pre">initialize_mu_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/white_noise_component.html#WhiteNoise.initialize_mu_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.white_noise_component.WhiteNoise.initialize_mu_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the mean of the hidden states.
Must define or validate the initial <cite>mu_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.white_noise_component.WhiteNoise.initialize_num_states">
<span class="sig-name descname"><span class="pre">initialize_num_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/white_noise_component.html#WhiteNoise.initialize_num_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.white_noise_component.WhiteNoise.initialize_num_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the number of hidden states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.white_noise_component.WhiteNoise.initialize_observation_matrix">
<span class="sig-name descname"><span class="pre">initialize_observation_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/white_noise_component.html#WhiteNoise.initialize_observation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.white_noise_component.WhiteNoise.initialize_observation_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the observation matrix.
Must define <cite>self._observation_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.white_noise_component.WhiteNoise.initialize_process_noise_matrix">
<span class="sig-name descname"><span class="pre">initialize_process_noise_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/white_noise_component.html#WhiteNoise.initialize_process_noise_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.white_noise_component.WhiteNoise.initialize_process_noise_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the process noise covariance matrix.
Must define <cite>self._process_noise_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.white_noise_component.WhiteNoise.initialize_states_name">
<span class="sig-name descname"><span class="pre">initialize_states_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/white_noise_component.html#WhiteNoise.initialize_states_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.white_noise_component.WhiteNoise.initialize_states_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the names of all hidden states.
Must provide <cite>self._states_name</cite> with a list of strings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.white_noise_component.WhiteNoise.initialize_transition_matrix">
<span class="sig-name descname"><span class="pre">initialize_transition_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/white_noise_component.html#WhiteNoise.initialize_transition_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.white_noise_component.WhiteNoise.initialize_transition_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the transition matrix.
Must define <cite>self._transition_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.white_noise_component.WhiteNoise.initialize_var_states">
<span class="sig-name descname"><span class="pre">initialize_var_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/white_noise_component.html#WhiteNoise.initialize_var_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.white_noise_component.WhiteNoise.initialize_var_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the variance of the hidden states.
Must define or validate the initial <cite>var_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

</dd></dl>

<dl class="py class" id="module-canari.component.lstm_component">
<dt class="sig sig-object py" id="canari.component.lstm_component.LstmNetwork">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.component.lstm_component.</span></span><span class="sig-name descname"><span class="pre">LstmNetwork</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">std_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_hidden_unit</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">look_back_len</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cpu'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_thread</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manual_seed</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain_weight</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gain_bias</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">load_lstm_net</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/lstm_component.html#LstmNetwork"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.lstm_component.LstmNetwork" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#canari.component.base_component.BaseComponent" title="canari.component.base_component.BaseComponent"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseComponent</span></code></a></p>
<p>LSTM component</p>
<dl class="py method">
<dt class="sig sig-object py" id="canari.component.lstm_component.LstmNetwork.initialize_component_name">
<span class="sig-name descname"><span class="pre">initialize_component_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/lstm_component.html#LstmNetwork.initialize_component_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.lstm_component.LstmNetwork.initialize_component_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the component’s name.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.lstm_component.LstmNetwork.initialize_lstm_network">
<span class="sig-name descname"><span class="pre">initialize_lstm_network</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Sequential</span></span></span><a class="reference internal" href="../_modules/canari/component/lstm_component.html#LstmNetwork.initialize_lstm_network"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.lstm_component.LstmNetwork.initialize_lstm_network" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.lstm_component.LstmNetwork.initialize_mu_states">
<span class="sig-name descname"><span class="pre">initialize_mu_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/lstm_component.html#LstmNetwork.initialize_mu_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.lstm_component.LstmNetwork.initialize_mu_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the mean of the hidden states.
Must define or validate the initial <cite>mu_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.lstm_component.LstmNetwork.initialize_num_states">
<span class="sig-name descname"><span class="pre">initialize_num_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/lstm_component.html#LstmNetwork.initialize_num_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.lstm_component.LstmNetwork.initialize_num_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the number of hidden states.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.lstm_component.LstmNetwork.initialize_observation_matrix">
<span class="sig-name descname"><span class="pre">initialize_observation_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/lstm_component.html#LstmNetwork.initialize_observation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.lstm_component.LstmNetwork.initialize_observation_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the observation matrix.
Must define <cite>self._observation_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.lstm_component.LstmNetwork.initialize_process_noise_matrix">
<span class="sig-name descname"><span class="pre">initialize_process_noise_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/lstm_component.html#LstmNetwork.initialize_process_noise_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.lstm_component.LstmNetwork.initialize_process_noise_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the process noise covariance matrix.
Must define <cite>self._process_noise_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.lstm_component.LstmNetwork.initialize_states_name">
<span class="sig-name descname"><span class="pre">initialize_states_name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/lstm_component.html#LstmNetwork.initialize_states_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.lstm_component.LstmNetwork.initialize_states_name" title="Link to this definition"></a></dt>
<dd><p>Initialize the names of all hidden states.
Must provide <cite>self._states_name</cite> with a list of strings.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.lstm_component.LstmNetwork.initialize_transition_matrix">
<span class="sig-name descname"><span class="pre">initialize_transition_matrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/lstm_component.html#LstmNetwork.initialize_transition_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.lstm_component.LstmNetwork.initialize_transition_matrix" title="Link to this definition"></a></dt>
<dd><p>Initialize the transition matrix.
Must define <cite>self._transition_matrix</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.component.lstm_component.LstmNetwork.initialize_var_states">
<span class="sig-name descname"><span class="pre">initialize_var_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/component/lstm_component.html#LstmNetwork.initialize_var_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.component.lstm_component.LstmNetwork.initialize_var_states" title="Link to this definition"></a></dt>
<dd><p>Initialize the variance of the hidden states.
Must define or validate the initial <cite>var_states</cite> as a 2D NumPy ndarray.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-canari.model">
<span id="model"></span><h2>Model<a class="headerlink" href="#module-canari.model" title="Link to this heading"></a></h2>
<p>Hybrid LSTM-State Space Model (SSM).</p>
<p>This module defines the <cite>Model</cite> class, which is a hybrid model that couples
Long Short-Term Memory (LSTM) and State-Space Modeling (SSM). The model supports
forecasting, filtering, smoothing.</p>
<dl class="py class">
<dt class="sig sig-object py" id="canari.model.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.model.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#canari.component.base_component.BaseComponent" title="canari.component.base_component.BaseComponent"><span class="pre">BaseComponent</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Hybrid LSTM/State-Space Model.</p>
<p>This model supports a flexible architecture where multiple <a href="#id1"><span class="problematic" id="id2">`</span></a>BaseComponent`s
are assembled to define a structured state-space system.</p>
<dl class="simple">
<dt>The model can:</dt><dd><ul class="simple">
<li><p>Forecast future observations with uncertainty quantification.</p></li>
<li><p>Filter observations using Bayesian updates.</p></li>
<li><p>Apply the RTS smoother for optimal state estimation.</p></li>
<li><p>Train its LSTM network component.</p></li>
<li><p>Automatically initialize or restore model states.</p></li>
<li><p>Generate synthetic time series data, including anomaly injection.</p></li>
<li><p>Perform online autoregressive updates.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model.Model.components">
<span class="sig-name descname"><span class="pre">components</span></span><a class="headerlink" href="#canari.model.Model.components" title="Link to this definition"></a></dt>
<dd><p>Dictionary of named state-space components.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, <a class="reference internal" href="#canari.component.base_component.BaseComponent" title="canari.component.base_component.BaseComponent">BaseComponent</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model.Model.states">
<span class="sig-name descname"><span class="pre">states</span></span><a class="headerlink" href="#canari.model.Model.states" title="Link to this definition"></a></dt>
<dd><p>Container for tracking state evolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>StatesHistory</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model.Model.lstm_net">
<span class="sig-name descname"><span class="pre">lstm_net</span></span><a class="headerlink" href="#canari.model.Model.lstm_net" title="Link to this definition"></a></dt>
<dd><p>LSTM neural network instance, if present.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optional[<a class="reference internal" href="#canari.component.lstm_component.LstmNetwork" title="canari.component.lstm_component.LstmNetwork">LstmNetwork</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model.Model.lstm_output_history">
<span class="sig-name descname"><span class="pre">lstm_output_history</span></span><a class="headerlink" href="#canari.model.Model.lstm_output_history" title="Link to this definition"></a></dt>
<dd><p>Rolling buffer of LSTM predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>LstmOutputHistory</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model.Model.observation_matrix">
<span class="sig-name descname"><span class="pre">observation_matrix</span></span><a class="headerlink" href="#canari.model.Model.observation_matrix" title="Link to this definition"></a></dt>
<dd><p>Matrix mapping hidden states to observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model.Model.transition_matrix">
<span class="sig-name descname"><span class="pre">transition_matrix</span></span><a class="headerlink" href="#canari.model.Model.transition_matrix" title="Link to this definition"></a></dt>
<dd><p>State transition matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model.Model.process_noise_matrix">
<span class="sig-name descname"><span class="pre">process_noise_matrix</span></span><a class="headerlink" href="#canari.model.Model.process_noise_matrix" title="Link to this definition"></a></dt>
<dd><p>Covariance of process noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mu_states,</span> <span class="pre">var_states</span></span></dt>
<dd><p>Mean and variance of the hidden states.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py">
<span class="sig-name descname"><span class="pre">mu_obs_predict,</span> <span class="pre">var_obs_predict</span></span></dt>
<dd><p>Predicted mean and variance of observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl>
<dt>Usage:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">LocalTrend</span><span class="p">(),</span> <span class="n">Periodic</span><span class="p">(),</span><span class="n">WhiteNoise</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu_pred</span><span class="p">,</span> <span class="n">std_pred</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.auto_initialize_baseline_states">
<span class="sig-name descname"><span class="pre">auto_initialize_baseline_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model.html#Model.auto_initialize_baseline_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.auto_initialize_baseline_states" title="Link to this definition"></a></dt>
<dd><p>Automatically assign initial baseline states values using trend decomposition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y</strong> (<em>np.ndarray</em>) – Time series data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.backward">
<span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/model.html#Model.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.backward" title="Link to this definition"></a></dt>
<dd><p>Update step in Kalman filter. Recall common.backward</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>float</em>) – Observed value.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(delta_mu, delta_var, posterior_mu, posterior_var)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.early_stopping">
<span class="sig-name descname"><span class="pre">early_stopping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/model.html#Model.early_stopping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.early_stopping" title="Link to this definition"></a></dt>
<dd><p>Determine early stopping condition during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>str</em>) – ‘min’ or ‘max’ metric optimization.</p></li>
<li><p><strong>patience</strong> (<em>int</em>) – Epochs to wait for improvement.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(stop_flag, best_epoch, best_score, history)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_lstm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StatesHistory</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/model.html#Model.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.filter" title="Link to this definition"></a></dt>
<dd><p>Perform Kalman filter over entire sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>) – Includes ‘x’ and ‘y’.</p></li>
<li><p><strong>train_lstm</strong> (<em>bool</em>) – Whether to updates LSTM’s parameter weights and biases.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(mean predictions, std deviations, filtered state history)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.forecast">
<span class="sig-name descname"><span class="pre">forecast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StatesHistory</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/model.html#Model.forecast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.forecast" title="Link to this definition"></a></dt>
<dd><p>Forecast over an entire dataset using repeated one-step predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>) – Contains key ‘x’ as input features.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(mean forecasts, std deviations, full state history)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_covariates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_lstm_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_lstm_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/model.html#Model.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.forward" title="Link to this definition"></a></dt>
<dd><p>Execute a one-step prediction. Recall common.forward</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_covariates</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Covariate vector.</p></li>
<li><p><strong>mu_lstm_pred</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Predicted mean from LSTM.</p></li>
<li><p><strong>var_lstm_pred</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Predicted variance from LSTM.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(mu_obs_pred, var_obs_pred, mu_states_prior, var_states_prior)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.generate_time_series">
<span class="sig-name descname"><span class="pre">generate_time_series</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_time_series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_time_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_from_lstm_pred</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_covariates</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_covariate_info</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_anomaly</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_mag_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_begin_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'trend'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/canari/model.html#Model.generate_time_series"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.generate_time_series" title="Link to this definition"></a></dt>
<dd><p>Generate synthetic time series from the original one optionally with added synthetic anomalies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_time_series</strong> (<em>int</em>) – Number of series to generate.</p></li>
<li><p><strong>num_time_steps</strong> (<em>int</em>) – Number of timesteps per series to generate data.</p></li>
<li><p><strong>...</strong> (<em>various</em>) – Anomaly and covariate controls.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Synthetic time series.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.get_dict">
<span class="sig-name descname"><span class="pre">get_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/canari/model.html#Model.get_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.get_dict" title="Link to this definition"></a></dt>
<dd><p>Export model attributes into a serializable dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Serializable model dictionary containing all major attributes.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.get_states_index">
<span class="sig-name descname"><span class="pre">get_states_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model.html#Model.get_states_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.get_states_index" title="Link to this definition"></a></dt>
<dd><p>Retrieve index of a state in the state vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>states_name</strong> (<em>str</em>) – The name of the state.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Index of the state, or None if not found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.initialize_states_history">
<span class="sig-name descname"><span class="pre">initialize_states_history</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model.html#Model.initialize_states_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.initialize_states_history" title="Link to this definition"></a></dt>
<dd><p>Start a new history buffer for priors, posteriors, and smoothers.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.initialize_states_with_smoother_estimates">
<span class="sig-name descname"><span class="pre">initialize_states_with_smoother_estimates</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model.html#Model.initialize_states_with_smoother_estimates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.initialize_states_with_smoother_estimates" title="Link to this definition"></a></dt>
<dd><p>Set states to the first smoothed values after smoothing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.load_dict">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model.html#Model.load_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.load_dict" title="Link to this definition"></a></dt>
<dd><p>Load model from dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>save_dict</strong> (<em>dict</em>) – Dictionary containing saved model structure and parameters.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Instantiated and parameterized model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#canari.model.Model" title="canari.model.Model">Model</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.lstm_train">
<span class="sig-name descname"><span class="pre">lstm_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">white_noise_decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">white_noise_max_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">white_noise_decay_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StatesHistory</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/model.html#Model.lstm_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.lstm_train" title="Link to this definition"></a></dt>
<dd><p>Train LSTM using train and validation sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>) – train data (x,y).</p></li>
<li><p><strong>validation_data</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>) – validation data (x,y).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(val_predictions, val_stds, states)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.rts_smoother">
<span class="sig-name descname"><span class="pre">rts_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix_inversion_tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model.html#Model.rts_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.rts_smoother" title="Link to this definition"></a></dt>
<dd><p>Apply RTS smoothing for a specific timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_step</strong> (<em>int</em>) – Target smoothing index.</p></li>
<li><p><strong>matrix_inversion_tol</strong> (<em>float</em>) – Numerical stability threshold.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.set_memory">
<span class="sig-name descname"><span class="pre">set_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StatesHistory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model.html#Model.set_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.set_memory" title="Link to this definition"></a></dt>
<dd><p>Load model state from a given timestep’s smoothed state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>states</strong> (<em>StatesHistory</em>) – Full history object.</p></li>
<li><p><strong>time_step</strong> (<em>int</em>) – Index of timestep to restore.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.set_posterior_states">
<span class="sig-name descname"><span class="pre">set_posterior_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_mu_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_var_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model.html#Model.set_posterior_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.set_posterior_states" title="Link to this definition"></a></dt>
<dd><p>Set the posterior state values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_mu_states</strong> (<em>np.ndarray</em>) – Posterior state means.</p></li>
<li><p><strong>new_var_states</strong> (<em>np.ndarray</em>) – Posterior state variances.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.set_states">
<span class="sig-name descname"><span class="pre">set_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_mu_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_var_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model.html#Model.set_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.set_states" title="Link to this definition"></a></dt>
<dd><p>Set new values for states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_mu_states</strong> (<em>np.ndarray</em>) – Mean values to be set.</p></li>
<li><p><strong>new_var_states</strong> (<em>np.ndarray</em>) – Covariance matrix to be set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model.Model.smoother">
<span class="sig-name descname"><span class="pre">smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">StatesHistory</span></span></span><a class="reference internal" href="../_modules/canari/model.html#Model.smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model.Model.smoother" title="Link to this definition"></a></dt>
<dd><p>Execute RTS smoothing backward pass over the whole time series data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em>) – Includes ‘y’.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Smoothed states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>StatesHistory</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-canari.model_optimizer">
<span id="model-optimizer"></span><h2>Model Optimizer<a class="headerlink" href="#module-canari.model_optimizer" title="Link to this heading"></a></h2>
<p>Module: model_optimizer</p>
<p>This module provides functionality to optimize hyperparameters for a machine learning model
using Ray Tune. It includes:</p>
<ul class="simple">
<li><p><cite>ModelOptimizer</cite>: A class to configure and run hyperparameter search (grid or random) with
support for Optuna and ASHA schedulers.</p></li>
<li><p><cite>CustomLogger</cite>: A Ray Tune callback for verbose trial progress logging.</p></li>
</ul>
<p>Usage:
<a href="#id3"><span class="problematic" id="id4">``</span></a><a href="#id5"><span class="problematic" id="id6">`</span></a>python
from model_optimizer import ModelOptimizer, CustomLogger</p>
<p># Define a model initialization function and a training function
# Provide a parameter search space and a DataProcess instance
optimizer = ModelOptimizer(</p>
<blockquote>
<div><p>initialize_model, train, param_space, data_processor,
num_optimization_trial=50, grid_search=False, algorithm=”default”</p>
</div></blockquote>
<p>)
optimizer.optimize()
best_model = optimizer.get_best_model()
<a href="#id7"><span class="problematic" id="id8">``</span></a><a href="#id9"><span class="problematic" id="id10">`</span></a></p>
<p>Requirements:
- ray[tune]
- optuna
- canari (for DataProcess)</p>
<p>Signal Handling:
Segmentation fault signals are ignored to prevent Ray Tune worker crashes.</p>
<dl class="py class">
<dt class="sig sig-object py" id="canari.model_optimizer.CustomLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.model_optimizer.</span></span><span class="sig-name descname"><span class="pre">CustomLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model_optimizer.html#CustomLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model_optimizer.CustomLogger" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Ray Tune callback for custom logging of trial progress.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.CustomLogger.total_samples">
<span class="sig-name descname"><span class="pre">total_samples</span></span><a class="headerlink" href="#canari.model_optimizer.CustomLogger.total_samples" title="Link to this definition"></a></dt>
<dd><p>Total number of expected trials.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.CustomLogger.current_sample">
<span class="sig-name descname"><span class="pre">current_sample</span></span><a class="headerlink" href="#canari.model_optimizer.CustomLogger.current_sample" title="Link to this definition"></a></dt>
<dd><p>Counter of completed samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.CustomLogger.trial_sample_map">
<span class="sig-name descname"><span class="pre">trial_sample_map</span></span><a class="headerlink" href="#canari.model_optimizer.CustomLogger.trial_sample_map" title="Link to this definition"></a></dt>
<dd><p>Maps trial IDs to their corresponding sample index.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model_optimizer.CustomLogger.on_trial_result">
<span class="sig-name descname"><span class="pre">on_trial_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model_optimizer.html#CustomLogger.on_trial_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model_optimizer.CustomLogger.on_trial_result" title="Link to this definition"></a></dt>
<dd><p>Log progress when a trial reports results.</p>
<p>Increments the sample counter, records a mapping from trial ID to
the sample index, and prints a formatted line containing the running
sample count, reported metric, and trial parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iteration</strong> (<em>int</em>) – Current iteration number of Ray Tune.</p></li>
<li><p><strong>trial</strong> (<em>Trial</em>) – The Ray Tune Trial object.</p></li>
<li><p><strong>result</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – Dictionary of trial results; must include key ‘metric’.</p></li>
<li><p><strong>**info</strong> – Additional callback info.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.model_optimizer.</span></span><span class="sig-name descname"><span class="pre">ModelOptimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initialize_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_processor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#canari.data_process.DataProcess" title="canari.data_process.DataProcess"><span class="pre">DataProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_optimization_trial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_search</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model_optimizer.html#ModelOptimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Optimize hyperparameters of a model using Ray Tune.</p>
<p>This class wraps the model initialization and training functions,
configures a hyperparameter search space, and runs the optimization
using either grid search or a configurable search algorithm.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer.initialize_model">
<span class="sig-name descname"><span class="pre">initialize_model</span></span><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer.initialize_model" title="Link to this definition"></a></dt>
<dd><p>Function that returns a model instance when given a config dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[Dict[str, Any]], Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer.train">
<span class="sig-name descname"><span class="pre">train</span></span><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer.train" title="Link to this definition"></a></dt>
<dd><p>Function that trains the model; should accept (model, data_processor)
and return a tuple whose first element is the trained model with
an attribute <cite>early_stop_metric</cite> for tuning.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Callable[[Any, <a class="reference internal" href="#canari.data_process.DataProcess" title="canari.data_process.DataProcess">DataProcess</a>], Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer.param_space">
<span class="sig-name descname"><span class="pre">param_space</span></span><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer.param_space" title="Link to this definition"></a></dt>
<dd><p>Mapping from parameter names to either
- a list of two values [min, max] for range sampling, or
- a list of discrete values for grid search.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, list]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer.data_processor">
<span class="sig-name descname"><span class="pre">data_processor</span></span><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer.data_processor" title="Link to this definition"></a></dt>
<dd><p>DataProcess instance for preparing and feeding training data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#canari.data_process.DataProcess" title="canari.data_process.DataProcess">DataProcess</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer.num_optimization_trial">
<span class="sig-name descname"><span class="pre">num_optimization_trial</span></span><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer.num_optimization_trial" title="Link to this definition"></a></dt>
<dd><p>Total number of trials for random search sampling (default: 50).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer.grid_search">
<span class="sig-name descname"><span class="pre">grid_search</span></span><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer.grid_search" title="Link to this definition"></a></dt>
<dd><p>If True, perform exhaustive grid search over given discrete values.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer.algorithm">
<span class="sig-name descname"><span class="pre">algorithm</span></span><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer.algorithm" title="Link to this definition"></a></dt>
<dd><p>Optimization algorithm: ‘default’ for OptunaSearch, ‘parallel’ for ASHAScheduler.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer.model_optim">
<span class="sig-name descname"><span class="pre">model_optim</span></span><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer.model_optim" title="Link to this definition"></a></dt>
<dd><p>The best model instance initialized with optimal parameters after running optimize().</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer.param_optim">
<span class="sig-name descname"><span class="pre">param_optim</span></span><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer.param_optim" title="Link to this definition"></a></dt>
<dd><p>The best hyperparameter configuration found during optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[str, Any]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer.get_best_model">
<span class="sig-name descname"><span class="pre">get_best_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model_optimizer.html#ModelOptimizer.get_best_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer.get_best_model" title="Link to this definition"></a></dt>
<dd><p>Retrieve the optimized model instance after running optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Model instance initialized with the best-found hyperparameters.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Any</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>RuntimeError</strong> – If <cite>optimize()</cite> has not been called yet.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.model_optimizer.ModelOptimizer.optimize">
<span class="sig-name descname"><span class="pre">optimize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/model_optimizer.html#ModelOptimizer.optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.model_optimizer.ModelOptimizer.optimize" title="Link to this definition"></a></dt>
<dd><p>Run hyperparameter optimization over the configured search space.</p>
<p>Depending on <cite>grid_search</cite>, either exhaustive grid search or random sampling
(using OptunaSearch or ASHAScheduler) is performed. The best configuration
and corresponding model are stored in <cite>param_optim</cite> and <cite>model_optim</cite>.</p>
<dl class="simple">
<dt>Prints:</dt><dd><p>Optimal trial number and parameter values.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-canari.SKF">
<span id="skf"></span><h2>SKF<a class="headerlink" href="#module-canari.SKF" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="canari.SKF.SKF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.SKF.</span></span><span class="sig-name descname"><span class="pre">SKF</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">norm_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#canari.model.Model" title="canari.model.Model"><span class="pre">Model</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">abnorm_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#canari.model.Model" title="canari.model.Model"><span class="pre">Model</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_transition_error</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_to_abnorm_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">abnorm_to_norm_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_model_prior_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conditional_likelihood</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Switching Kalman Filter (SKF)</p>
<p>Combines two state-space models (normal and abnormal) into a probabilistic
switching framework. It supports anomaly detection by computing probabilities of both models.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="canari.SKF.SKF.norm_to_abnorm_prob">
<span class="sig-name descname"><span class="pre">norm_to_abnorm_prob</span></span><a class="headerlink" href="#canari.SKF.SKF.norm_to_abnorm_prob" title="Link to this definition"></a></dt>
<dd><p>Transition probability from normal to abnormal.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.SKF.SKF.abnorm_to_norm_prob">
<span class="sig-name descname"><span class="pre">abnorm_to_norm_prob</span></span><a class="headerlink" href="#canari.SKF.SKF.abnorm_to_norm_prob" title="Link to this definition"></a></dt>
<dd><p>Transition probability from abnormal to normal.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.SKF.SKF.norm_model_prior_prob">
<span class="sig-name descname"><span class="pre">norm_model_prior_prob</span></span><a class="headerlink" href="#canari.SKF.SKF.norm_model_prior_prob" title="Link to this definition"></a></dt>
<dd><p>Prior probability of being in the normal state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.SKF.SKF.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#canari.SKF.SKF.model" title="Link to this definition"></a></dt>
<dd><p>Dictionary of transition model instances (norm_norm, norm_abnorm, etc.).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.SKF.SKF.states">
<span class="sig-name descname"><span class="pre">states</span></span><a class="headerlink" href="#canari.SKF.SKF.states" title="Link to this definition"></a></dt>
<dd><p>History of collapsed marginal states.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>StatesHistory</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.SKF.SKF.transition_coef">
<span class="sig-name descname"><span class="pre">transition_coef</span></span><a class="headerlink" href="#canari.SKF.SKF.transition_coef" title="Link to this definition"></a></dt>
<dd><p>Transition coefficients computed per timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.auto_initialize_baseline_states">
<span class="sig-name descname"><span class="pre">auto_initialize_baseline_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.auto_initialize_baseline_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.auto_initialize_baseline_states" title="Link to this definition"></a></dt>
<dd><p>Automatically initialize baseline states from data for normal model.</p>
<p>Delegates to the normal regime model to estimate initial state means and variances
from observations, then saves these initial states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y</strong> (<em>np.ndarray</em>) – Observed data for baseline initialization.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.backward">
<span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.backward" title="Link to this definition"></a></dt>
<dd><p>Backward update step: collapse posterior states after observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>obs</strong> (<em>float</em>) – Observation at current time step.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Posterior state estimates.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple(mu_states_posterior, var_states_posterior)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.detect_synthetic_anomaly">
<span class="sig-name descname"><span class="pre">detect_synthetic_anomaly</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_timestep_to_detect</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_anomaly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">slope_anomaly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.33</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">anomaly_end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.66</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.detect_synthetic_anomaly"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.detect_synthetic_anomaly" title="Link to this definition"></a></dt>
<dd><p>Detect synthetic anomalies and compute detection/false-alarm rates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>list</em><em>[</em><em>dict</em><em>]</em>) – List of original time series dicts.</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Probability cutoff for anomaly detection.</p></li>
<li><p><strong>max_timestep_to_detect</strong> (<em>int</em>) – Window length post-anomaly for detection.</p></li>
<li><p><strong>num_anomaly</strong> (<em>int</em>) – Number of synthetic anomalies to insert.</p></li>
<li><p><strong>slope_anomaly</strong> (<em>float</em>) – Magnitude of anomaly slope.</p></li>
<li><p><strong>anomaly_start</strong> (<em>float</em>) – Fractional start position of anomaly.</p></li>
<li><p><strong>anomaly_end</strong> (<em>float</em>) – Fractional end position of anomaly.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>detection_rate (float): Fraction of anomalies detected.
false_rate (float): Fraction of false alarms post-insertion.
false_alarm_train (str): ‘Yes’ if any alarm during training data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple(detection_rate, false_rate, false_alarm_train)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.early_stopping">
<span class="sig-name descname"><span class="pre">early_stopping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'max'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate_metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">skip_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.early_stopping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.early_stopping" title="Link to this definition"></a></dt>
<dd><p>Apply early stopping policy from the normal model’s training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<em>str</em>) – ‘max’ or ‘min’ to maximize or minimize the metric.</p></li>
<li><p><strong>patience</strong> (<em>int</em>) – Number of epochs without improvement allowed.</p></li>
<li><p><strong>evaluate_metric</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Current metric value to evaluate.</p></li>
<li><p><strong>skip_epoch</strong> (<em>int</em>) – Epoch count before starting to monitor.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple indicating (stop_flag, optimal_epoch, best_metric, history_list).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.filter">
<span class="sig-name descname"><span class="pre">filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StatesHistory</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.filter" title="Link to this definition"></a></dt>
<dd><p>Run filtering over a time series and record abnormal probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – Contains ‘x’ (covariates) and ‘y’ (observations).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Abnormal marginal probabilities and state history.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple(abnorm_probs, StatesHistory)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_covariates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.forward" title="Link to this definition"></a></dt>
<dd><p>Forward pass across all transition models to predict next observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>float</em>) – Current observation.</p></li>
<li><p><strong>input_covariates</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Exogenous inputs for LSTM.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted observation mean and variance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple(mu_obs_pred, var_obs_pred)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.get_dict">
<span class="sig-name descname"><span class="pre">get_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.get_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.get_dict" title="Link to this definition"></a></dt>
<dd><p>Serialize the SKF and underlying models into a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Contains serialized normal/abnormal models, transition parameters,
prior probabilities, and any trained LSTM parameters.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.initialize_states_history">
<span class="sig-name descname"><span class="pre">initialize_states_history</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.initialize_states_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.initialize_states_history" title="Link to this definition"></a></dt>
<dd><p>Initialize state history containers for all transition models.</p>
<p>Invokes each model’s own initialization, then sets combined StatesHistory
based on self.states_name.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.load_dict">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.load_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.load_dict" title="Link to this definition"></a></dt>
<dd><p>Reconstruct an SKF instance from its serialized dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>save_dict</strong> (<em>dict</em>) – Dictionary produced by get_dict(), containing model states and params.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new SKF object with loaded parameters and states.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#canari.SKF.SKF" title="canari.SKF.SKF">SKF</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.load_initial_states">
<span class="sig-name descname"><span class="pre">load_initial_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.load_initial_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.load_initial_states" title="Link to this definition"></a></dt>
<dd><p>Restore saved initial states into the normal model.</p>
<p>Copies back self.mu_states_init and self.var_states_init into the normal model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.lstm_train">
<span class="sig-name descname"><span class="pre">lstm_train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">white_noise_decay</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">white_noise_max_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">white_noise_decay_factor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.9</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StatesHistory</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.lstm_train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.lstm_train" title="Link to this definition"></a></dt>
<dd><p>Train the normal regime’s LSTM network and record training history.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_data</strong> (<em>dict</em>) – Input/observation arrays for training.</p></li>
<li><p><strong>validation_data</strong> (<em>dict</em>) – Data for validation during training.</p></li>
<li><p><strong>white_noise_decay</strong> (<em>bool</em>) – Whether to decay noise over epochs.</p></li>
<li><p><strong>white_noise_max_std</strong> (<em>float</em>) – Maximum std for injected white noise.</p></li>
<li><p><strong>white_noise_decay_factor</strong> (<em>float</em>) – Multiplicative decay per epoch.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple containing training losses, validation losses, and StatesHistory.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.marginal">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">marginal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.marginal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.marginal" title="Link to this definition"></a></dt>
<dd><p>Create a dictionary for mariginal</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.prob_history">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prob_history</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.prob_history"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.prob_history" title="Link to this definition"></a></dt>
<dd><p>Create a dictionary to save marginal probability history</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.rts_smoother">
<span class="sig-name descname"><span class="pre">rts_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.rts_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.rts_smoother" title="Link to this definition"></a></dt>
<dd><p>Run Rauch–Tung–Striebel smoother at a given time step.</p>
<p>Updates smoothed state estimates and transition coefficients based on
forward filter history and transition probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>time_step</strong> (<em>int</em>) – Index at which to perform smoothing.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.save_initial_states">
<span class="sig-name descname"><span class="pre">save_initial_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.save_initial_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.save_initial_states" title="Link to this definition"></a></dt>
<dd><p>Save initial SKF state mean/variance for reuse in subsequent runs.</p>
<p>Stores copies of the normal model’s current mu_states and var_states in
self.mu_states_init and self.var_states_init.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.set_memory">
<span class="sig-name descname"><span class="pre">set_memory</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StatesHistory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_step</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.set_memory"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.set_memory" title="Link to this definition"></a></dt>
<dd><p>Set model memory at a given time step and optionally reset to initial.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>states</strong> (<em>StatesHistory</em>) – StatesHistory object to load into norm_norm.</p></li>
<li><p><strong>time_step</strong> (<em>int</em>) – Index of time step; if 0, reload initial states and reset marginals.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.set_same_states_transition_models">
<span class="sig-name descname"><span class="pre">set_same_states_transition_models</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.set_same_states_transition_models"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.set_same_states_transition_models" title="Link to this definition"></a></dt>
<dd><p>Synchronize all transition models to the same hidden-state initialization.</p>
<p>Copies the initial mu_states and var_states from norm_norm to every model
in self.model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.set_states">
<span class="sig-name descname"><span class="pre">set_states</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.set_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.set_states" title="Link to this definition"></a></dt>
<dd><p>Assign posterior states to be used as priors for next time step.</p>
<p>For each transition model, sets its mu_states and var_states from
the latest posterior estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.smoother">
<span class="sig-name descname"><span class="pre">smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">StatesHistory</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.smoother" title="Link to this definition"></a></dt>
<dd><p>Apply RTS smoothing over entire time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>dict</em>) – Contains ‘x’ and ‘y’ arrays for smoothing.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Smoothed abnormal probabilities and history.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple(smoothed_abnorm_probs, StatesHistory)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF.SKF.transition">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">transition</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF.html#SKF.transition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF.SKF.transition" title="Link to this definition"></a></dt>
<dd><p>Create a dictionary for transition</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-canari.SKF_optimizer">
<span id="skf-optimizer"></span><h2>SKF Optimizer<a class="headerlink" href="#module-canari.SKF_optimizer" title="Link to this heading"></a></h2>
<p>Module: skf_optimizer</p>
<p>Optimizers for parameter tuning of SKF detection pipelines using Ray Tune.</p>
<p>Classes:</p>
<ul class="simple">
<li><p>SKFOptimizer: automated hyperparameter search using grid search or Bayesian optimization via Optuna/ASHAScheduler.</p></li>
<li><p>CustomLogger: custom callback for progress logging during hyperparameter trials.</p></li>
</ul>
<p>Usage example:</p>
<p><a href="#id11"><span class="problematic" id="id12">``</span></a><a href="#id13"><span class="problematic" id="id14">`</span></a>python
from skf_optimizer import SKFOptimizer</p>
<dl class="simple">
<dt>def init_skf(config, model_params):</dt><dd><p># initialize your SKF detector with config and model parameters
return MySKFDetector(<a href="#id15"><span class="problematic" id="id16">**</span></a>model_params, <a href="#id17"><span class="problematic" id="id18">**</span></a>config)</p>
</dd>
</dl>
<p>model_params = {…}
param_space = {“slope”: [0.1, 2.0]}
data = {…}</p>
<dl class="simple">
<dt>optimizer = SKFOptimizer(</dt><dd><p>initialize_skf=init_skf,
model_param=model_params,
param_space=param_space,
data=data,
detection_threshold=0.6,
false_rate_threshold=0.1,
num_optimization_trial=100,</p>
</dd>
</dl>
<p>)
optimizer.optimize()
best_model = optimizer.get_best_model()
<a href="#id19"><span class="problematic" id="id20">``</span></a><a href="#id21"><span class="problematic" id="id22">`</span></a></p>
<dl class="py class">
<dt class="sig sig-object py" id="canari.SKF_optimizer.CustomLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.SKF_optimizer.</span></span><span class="sig-name descname"><span class="pre">CustomLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">total_samples</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF_optimizer.html#CustomLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF_optimizer.CustomLogger" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Ray Tune callback for logging trial progress.</p>
<p>Logs the sample count and metrics for each trial as they complete.</p>
<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF_optimizer.CustomLogger.on_trial_result">
<span class="sig-name descname"><span class="pre">on_trial_result</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">iteration</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">result</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">info</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF_optimizer.html#CustomLogger.on_trial_result"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF_optimizer.CustomLogger.on_trial_result" title="Link to this definition"></a></dt>
<dd><p>Called when a trial reports intermediate results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>iteration</strong> (<em>int</em>) – Current iteration number.</p></li>
<li><p><strong>trial</strong> (<em>Trial</em>) – Trial object.</p></li>
<li><p><strong>result</strong> (<em>dict</em>) – Metrics reported by the trial.</p></li>
<li><p><strong>**info</strong> – Additional info.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="canari.SKF_optimizer.SKFOptimizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.SKF_optimizer.</span></span><span class="sig-name descname"><span class="pre">SKFOptimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initialize_skf</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_param</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detection_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">false_rate_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_timestep_to_detect</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_synthetic_anomaly</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_optimization_trial</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">grid_search</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF_optimizer.html#SKFOptimizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF_optimizer.SKFOptimizer" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Parameter optimizer for SKF anomaly detection pipelines.</p>
<p>This class runs hyperparameter search over the SKF detector configuration
using Ray Tune. Supports both grid search and sampling-based algorithms
(Optuna or ASHA scheduler).</p>
<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF_optimizer.SKFOptimizer.get_best_model">
<span class="sig-name descname"><span class="pre">get_best_model</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF_optimizer.html#SKFOptimizer.get_best_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF_optimizer.SKFOptimizer.get_best_model" title="Link to this definition"></a></dt>
<dd><p>Retrieves the SKF detector instance initialized with the best parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>SKF detector instance corresponding to the optimal configuration.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Any</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.SKF_optimizer.SKFOptimizer.optimize">
<span class="sig-name descname"><span class="pre">optimize</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/SKF_optimizer.html#SKFOptimizer.optimize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.SKF_optimizer.SKFOptimizer.optimize" title="Link to this definition"></a></dt>
<dd><p>Executes the hyperparameter search.</p>
<p>Runs either grid search or sampling-based trials and logs progress.
After completion, stores <cite>param_optim</cite> and <cite>skf_optim</cite>.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-canari.common">
<span id="common-functions"></span><h2>Common functions<a class="headerlink" href="#module-canari.common" title="Link to this heading"></a></h2>
<p>Utility functions</p>
<dl class="py class">
<dt class="sig sig-object py" id="canari.common.GMA">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">canari.common.</span></span><span class="sig-name descname"><span class="pre">GMA</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/common.html#GMA"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.GMA" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Gaussian Multiplicative Approximation (GMA).</p>
<p>Provides a way to augment and approximate the product of two Gaussian variables.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="canari.common.GMA.mu">
<span class="sig-name descname"><span class="pre">mu</span></span><a class="headerlink" href="#canari.common.GMA.mu" title="Link to this definition"></a></dt>
<dd><p>Mean vector.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="canari.common.GMA.var">
<span class="sig-name descname"><span class="pre">var</span></span><a class="headerlink" href="#canari.common.GMA.var" title="Link to this definition"></a></dt>
<dd><p>Covariance matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.common.GMA.delete">
<span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/common.html#GMA.delete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.GMA.delete" title="Link to this definition"></a></dt>
<dd><p>Remove a variable from the mean and covariance structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>index</strong> (<em>int</em>) – Index of the variable to delete.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.common.GMA.get_results">
<span class="sig-name descname"><span class="pre">get_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/common.html#GMA.get_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.GMA.get_results" title="Link to this definition"></a></dt>
<dd><p>Get the current mean and covariance.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Mean vector and covariance matrix.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.common.GMA.multiply_and_augment">
<span class="sig-name descname"><span class="pre">multiply_and_augment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/common.html#GMA.multiply_and_augment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.GMA.multiply_and_augment" title="Link to this definition"></a></dt>
<dd><p>Augment mean and covariance with the product of two variables.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="canari.common.GMA.swap">
<span class="sig-name descname"><span class="pre">swap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/common.html#GMA.swap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.GMA.swap" title="Link to this definition"></a></dt>
<dd><p>Swap two variables in the mean and covariance structures.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index1</strong> (<em>int</em>) – Index of the first variable.</p></li>
<li><p><strong>index2</strong> (<em>int</em>) – Index of the second variable.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.common.backward">
<span class="sig-prename descclassname"><span class="pre">canari.common.</span></span><span class="sig-name descname"><span class="pre">backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_obs_predict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_obs_predict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states_prior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/common.html#backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.backward" title="Link to this definition"></a></dt>
<dd><p>Perform the backward pass for Kalman update.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<em>float</em>) – Actual observation value.</p></li>
<li><p><strong>mu_obs_predict</strong> (<em>np.ndarray</em>) – Predicted observation mean.</p></li>
<li><p><strong>var_obs_predict</strong> (<em>np.ndarray</em>) – Predicted observation variance.</p></li>
<li><p><strong>var_states_prior</strong> (<em>np.ndarray</em>) – Prior state covariance matrix.</p></li>
<li><p><strong>observation_matrix</strong> (<em>np.ndarray</em>) – Observation model matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Correction for state mean and covariance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.common.calc_observation">
<span class="sig-prename descclassname"><span class="pre">canari.common.</span></span><span class="sig-name descname"><span class="pre">calc_observation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/common.html#calc_observation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.calc_observation" title="Link to this definition"></a></dt>
<dd><p>Predict observation mean and variance from state estimates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu_states</strong> (<em>np.ndarray</em>) – Mean of the state variables.</p></li>
<li><p><strong>var_states</strong> (<em>np.ndarray</em>) – Covariance matrix of the state variables.</p></li>
<li><p><strong>observation_matrix</strong> (<em>np.ndarray</em>) – Observation model matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted mean and variance of observations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.common.create_block_diag">
<span class="sig-prename descclassname"><span class="pre">canari.common.</span></span><span class="sig-name descname"><span class="pre">create_block_diag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arrays</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/canari/common.html#create_block_diag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.create_block_diag" title="Link to this definition"></a></dt>
<dd><p>Create a block diagonal matrix from the provided arrays.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>*arrays</strong> (<em>np.ndarray</em>) – Variable number of 2D arrays.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Block diagonal matrix with input arrays along the diagonal.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.common.forward">
<span class="sig-prename descclassname"><span class="pre">canari.common.</span></span><span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_states_posterior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states_posterior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transition_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">process_noise_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observation_matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_lstm_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_lstm_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lstm_indice</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/common.html#forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.forward" title="Link to this definition"></a></dt>
<dd><p>Perform the forward pass for Kalman filtering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu_states_posterior</strong> (<em>np.ndarray</em>) – Posterior state means.</p></li>
<li><p><strong>var_states_posterior</strong> (<em>np.ndarray</em>) – Posterior state covariance.</p></li>
<li><p><strong>transition_matrix</strong> (<em>np.ndarray</em>) – State transition matrix.</p></li>
<li><p><strong>process_noise_matrix</strong> (<em>np.ndarray</em>) – Covariance of the process noise.</p></li>
<li><p><strong>observation_matrix</strong> (<em>np.ndarray</em>) – Observation model matrix.</p></li>
<li><p><strong>mu_lstm_pred</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – LSTM predicted mean (optional).</p></li>
<li><p><strong>var_lstm_pred</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – LSTM predicted variance (optional).</p></li>
<li><p><strong>lstm_indice</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – Index to insert LSTM predictions (optional).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted observation mean/var and state prior mean/var.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.common.gaussian_mixture">
<span class="sig-prename descclassname"><span class="pre">canari.common.</span></span><span class="sig-name descname"><span class="pre">gaussian_mixture</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef1</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coef2</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/common.html#gaussian_mixture"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.gaussian_mixture" title="Link to this definition"></a></dt>
<dd><p>Perform a reduction of two Gaussian distributions into a single mixture distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu1</strong> (<em>np.ndarray</em>) – Mean vector of the first Gaussian.</p></li>
<li><p><strong>var1</strong> (<em>np.ndarray</em>) – Covariance matrix of the first Gaussian.</p></li>
<li><p><strong>coef1</strong> (<em>float</em>) – Mixture weight for the first Gaussian.</p></li>
<li><p><strong>mu2</strong> (<em>np.ndarray</em>) – Mean vector of the second Gaussian.</p></li>
<li><p><strong>var2</strong> (<em>np.ndarray</em>) – Covariance matrix of the second Gaussian.</p></li>
<li><p><strong>coef2</strong> (<em>float</em>) – Mixture weight for the second Gaussian.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mixture mean vector and covariance matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.common.pad_matrix">
<span class="sig-prename descclassname"><span class="pre">canari.common.</span></span><span class="sig-name descname"><span class="pre">pad_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">matrix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_row</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pad_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/common.html#pad_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.pad_matrix" title="Link to this definition"></a></dt>
<dd><p>Add a row and/or column padding to the matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>np.ndarray</em>) – Matrix to pad.</p></li>
<li><p><strong>pad_index</strong> (<em>int</em>) – Index to insert the padding.</p></li>
<li><p><strong>pad_row</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Row vector to insert.</p></li>
<li><p><strong>pad_col</strong> (<em>Optional</em><em>[</em><em>np.ndarray</em><em>]</em>) – Column vector to insert.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Padded matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.common.prepare_lstm_input">
<span class="sig-prename descclassname"><span class="pre">canari.common.</span></span><span class="sig-name descname"><span class="pre">prepare_lstm_input</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lstm_output_history</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LstmOutputHistory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_covariates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/common.html#prepare_lstm_input"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.prepare_lstm_input" title="Link to this definition"></a></dt>
<dd><p>Prepare LSTM input by concatenating past LSTM outputs with current input covariates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lstm_output_history</strong> (<em>LstmOutputHistory</em>) – Historical LSTM mean/variance.</p></li>
<li><p><strong>input_covariates</strong> (<em>np.ndarray</em>) – Input covariates.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>LSTM input mean and variance vectors.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.common.rts_smoother">
<span class="sig-prename descclassname"><span class="pre">canari.common.</span></span><span class="sig-name descname"><span class="pre">rts_smoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_states_prior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states_prior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_states_smooth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states_smooth</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu_states_posterior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_states_posterior</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cross_cov_states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix_inversion_tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-12</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">ndarray</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/canari/common.html#rts_smoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.rts_smoother" title="Link to this definition"></a></dt>
<dd><p>Rauch-Tung-Striebel (RTS) smoother.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu_states_prior</strong> (<em>np.ndarray</em>) – Prior mean vector.</p></li>
<li><p><strong>var_states_prior</strong> (<em>np.ndarray</em>) – Prior covariance metrix.</p></li>
<li><p><strong>mu_states_smooth</strong> (<em>np.ndarray</em>) – Smoothed mean vector.</p></li>
<li><p><strong>var_states_smooth</strong> (<em>np.ndarray</em>) – Smoothed covariance matrix.</p></li>
<li><p><strong>mu_states_posterior</strong> (<em>np.ndarray</em>) – Posterior mean vector.</p></li>
<li><p><strong>var_states_posterior</strong> (<em>np.ndarray</em>) – Posterior covariance matrix.</p></li>
<li><p><strong>cross_cov_states</strong> (<em>np.ndarray</em>) – Cross-covariance matrix between states at two consecutive time steps.</p></li>
<li><p><strong>matrix_inversion_tol</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em>) – Regularization tolerance.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Updated smoothed mean and covariance.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.common.unstandardize_states">
<span class="sig-prename descclassname"><span class="pre">canari.common.</span></span><span class="sig-name descname"><span class="pre">unstandardize_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu_norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_norm</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_const_mean</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm_const_std</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/common.html#unstandardize_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.common.unstandardize_states" title="Link to this definition"></a></dt>
<dd><p>Unstandardize normalized mean and standard deviation of states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu_norm</strong> (<em>dict</em>) – Normalized means by key.</p></li>
<li><p><strong>std_norm</strong> (<em>dict</em>) – Normalized stds by key.</p></li>
<li><p><strong>norm_const_mean</strong> (<em>float</em>) – Mean normalization constant.</p></li>
<li><p><strong>norm_const_std</strong> (<em>float</em>) – Standard deviation normalization constant.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Unnormalized means and stds.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[dict, dict]</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-canari.data_visualization">
<span id="data-visualization"></span><h2>Data Visualization<a class="headerlink" href="#module-canari.data_visualization" title="Link to this heading"></a></h2>
<p>Visualization for Canari’s results.</p>
<p>This module provides plotting functions for:
- Raw or normalized data (train, validation, and test splits)
- Prediction results with uncertainty (mean ± standard deviation)
- Hidden state estimates (posterior or prior) from state-space models
- Abnormal regime-switching probabilities from Switching Kalman filters</p>
<dl class="py function">
<dt class="sig sig-object py" id="canari.data_visualization.plot_data">
<span class="sig-prename descclassname"><span class="pre">canari.data_visualization.</span></span><span class="sig-name descname"><span class="pre">plot_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_processor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#canari.data_process.DataProcess" title="canari.data_process.DataProcess"><span class="pre">DataProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_train_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_validation_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_test_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'r'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_nan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/data_visualization.html#plot_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_visualization.plot_data" title="Link to this definition"></a></dt>
<dd><p>Plot train, validation, and test data with optional normalization and NaN filtering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_processor</strong> (<a class="reference internal" href="#canari.data_process.DataProcess" title="canari.data_process.DataProcess"><em>DataProcess</em></a>) – Object that wraps the dataset and split metadata.</p></li>
<li><p><strong>normalization</strong> (<em>bool</em><em>, </em><em>optional</em>) – Normalize the data using stored statistics.</p></li>
<li><p><strong>plot_train_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, plot training data.</p></li>
<li><p><strong>plot_validation_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, plot validation data.</p></li>
<li><p><strong>plot_test_data</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, plot test data.</p></li>
<li><p><strong>plot_column</strong> (<em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – List of column indices to plot.</p></li>
<li><p><strong>sub_plot</strong> (<em>plt.Axes</em><em>, </em><em>optional</em>) – Matplotlib subplot axis to plot on.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – Line color for plot lines.</p></li>
<li><p><strong>linestyle</strong> (<em>str</em><em>, </em><em>optional</em>) – Line style (e.g., ‘-’, ‘–‘).</p></li>
<li><p><strong>train_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Legend label for training data.</p></li>
<li><p><strong>validation_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Legend label for validation data.</p></li>
<li><p><strong>test_label</strong> (<em>str</em><em>, </em><em>optional</em>) – Legend label for test data.</p></li>
<li><p><strong>plot_nan</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to include NaN values in the plot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.data_visualization.plot_prediction">
<span class="sig-prename descclassname"><span class="pre">canari.data_visualization.</span></span><span class="sig-name descname"><span class="pre">plot_prediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_processor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#canari.data_process.DataProcess" title="canari.data_process.DataProcess"><span class="pre">DataProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_train_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_train_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_validation_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_validation_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean_test_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std_test_pred</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'blue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['',</span> <span class="pre">'']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">validation_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['',</span> <span class="pre">'']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['',</span> <span class="pre">'']</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/data_visualization.html#plot_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_visualization.plot_prediction" title="Link to this definition"></a></dt>
<dd><p>Plot predicted mean and uncertainty (standard deviation) for each data split.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_processor</strong> (<a class="reference internal" href="#canari.data_process.DataProcess" title="canari.data_process.DataProcess"><em>DataProcess</em></a>) – Data processing object.</p></li>
<li><p><strong>mean_train_pred</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Predicted means for training.</p></li>
<li><p><strong>std_train_pred</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Standard deviations for training predictions.</p></li>
<li><p><strong>mean_validation_pred</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Predicted means for validation.</p></li>
<li><p><strong>std_validation_pred</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Standard deviations for validation.</p></li>
<li><p><strong>mean_test_pred</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Predicted means for test.</p></li>
<li><p><strong>std_test_pred</strong> (<em>np.ndarray</em><em>, </em><em>optional</em>) – Standard deviations for test.</p></li>
<li><p><strong>num_std</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of std deviations for uncertainty bands.</p></li>
<li><p><strong>sub_plot</strong> (<em>plt.Axes</em><em>, </em><em>optional</em>) – Axis to plot on.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – Line color.</p></li>
<li><p><strong>linestyle</strong> (<em>str</em><em>, </em><em>optional</em>) – Line style.</p></li>
<li><p><strong>train_label</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – [mean_label, std_label] for train.</p></li>
<li><p><strong>validation_label</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – [mean_label, std_label] for validation.</p></li>
<li><p><strong>test_label</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – [mean_label, std_label] for test.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.data_visualization.plot_skf_states">
<span class="sig-prename descclassname"><span class="pre">canari.data_visualization.</span></span><span class="sig-name descname"><span class="pre">plot_skf_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_processor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#canari.data_process.DataProcess" title="canari.data_process.DataProcess"><span class="pre">DataProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StatesHistory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_prob</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states_to_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'posterior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_observation</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_nan</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/data_visualization.html#plot_skf_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_visualization.plot_skf_states" title="Link to this definition"></a></dt>
<dd><p>Plot hidden states along with model-switching probabilities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_processor</strong> (<a class="reference internal" href="#canari.data_process.DataProcess" title="canari.data_process.DataProcess"><em>DataProcess</em></a>) – Input data and splits.</p></li>
<li><p><strong>states</strong> (<em>StatesHistory</em>) – Posterior/prior state values.</p></li>
<li><p><strong>model_prob</strong> (<em>np.ndarray</em>) – Probabilities of abnormal regime.</p></li>
<li><p><strong>states_to_plot</strong> (<em>list</em><em>[</em><em>str</em><em>] or </em><em>&quot;all&quot;</em><em>, </em><em>optional</em>) – Which states to visualize.</p></li>
<li><p><strong>states_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of state (posterior/prior).</p></li>
<li><p><strong>normalization</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to convert states back to original scale.</p></li>
<li><p><strong>num_std</strong> (<em>int</em><em>, </em><em>optional</em>) – Width of uncertainty interval in std units.</p></li>
<li><p><strong>plot_observation</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to include observed data.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – Line color for states.</p></li>
<li><p><strong>linestyle</strong> (<em>str</em><em>, </em><em>optional</em>) – Line style.</p></li>
<li><p><strong>legend_location</strong> (<em>str</em><em>, </em><em>optional</em>) – Location of legend in top subplot.</p></li>
<li><p><strong>plot_nan</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to include NaNs in observed values.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.data_visualization.plot_states">
<span class="sig-prename descclassname"><span class="pre">canari.data_visualization.</span></span><span class="sig-name descname"><span class="pre">plot_states</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_processor</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#canari.data_process.DataProcess" title="canari.data_process.DataProcess"><span class="pre">DataProcess</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">states</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">StatesHistory</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states_to_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">states_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'posterior'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalization</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'b'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legend_location</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/data_visualization.html#plot_states"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_visualization.plot_states" title="Link to this definition"></a></dt>
<dd><p>Plot hidden states with mean and uncertainty intervals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_processor</strong> (<a class="reference internal" href="#canari.data_process.DataProcess" title="canari.data_process.DataProcess"><em>DataProcess</em></a>) – Data and metadata handler.</p></li>
<li><p><strong>states</strong> (<em>StatesHistory</em>) – Object containing state estimates.</p></li>
<li><p><strong>states_to_plot</strong> (<em>list</em><em>[</em><em>str</em><em>] or </em><em>&quot;all&quot;</em><em>, </em><em>optional</em>) – Names of states to plot.</p></li>
<li><p><strong>states_type</strong> (<em>str</em><em>, </em><em>optional</em>) – Type of state (‘posterior’ or ‘prior’).</p></li>
<li><p><strong>normalization</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to unnormalize the states.</p></li>
<li><p><strong>num_std</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of standard deviations for error bands.</p></li>
<li><p><strong>sub_plot</strong> (<em>plt.Axes</em><em>, </em><em>optional</em>) – Single shared axis to plot all states.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – Color for mean line and uncertainty fill.</p></li>
<li><p><strong>linestyle</strong> (<em>str</em><em>, </em><em>optional</em>) – Line style.</p></li>
<li><p><strong>legend_location</strong> (<em>str</em><em>, </em><em>optional</em>) – Legend placement for first state subplot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="canari.data_visualization.plot_with_uncertainty">
<span class="sig-prename descclassname"><span class="pre">canari.data_visualization.</span></span><span class="sig-name descname"><span class="pre">plot_with_uncertainty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">std</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linestyle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'-'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['',</span> <span class="pre">'']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_std</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/canari/data_visualization.html#plot_with_uncertainty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#canari.data_visualization.plot_with_uncertainty" title="Link to this definition"></a></dt>
<dd><p>Plot mean and confidence interval for a variable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<em>np.ndarray</em>) – Time vector.</p></li>
<li><p><strong>mu</strong> (<em>np.ndarray</em>) – Mean values to plot.</p></li>
<li><p><strong>std</strong> (<em>np.ndarray</em>) – Standard deviation values.</p></li>
<li><p><strong>color</strong> (<em>str</em><em>, </em><em>optional</em>) – Line/fill color.</p></li>
<li><p><strong>linestyle</strong> (<em>str</em><em>, </em><em>optional</em>) – Line style.</p></li>
<li><p><strong>label</strong> (<em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Labels for mean and band.</p></li>
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – Index if plotting from multivariate tensor.</p></li>
<li><p><strong>num_std</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of standard deviations to shade.</p></li>
<li><p><strong>ax</strong> (<em>plt.Axes</em><em>, </em><em>optional</em>) – Axis to use for plotting.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../examples/tutorial_forecast.html" class="btn btn-neutral float-left" title="Forecasting with Canari" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Van-Dai Vuong, Luong-Ha Nguyen, James-A. Goulet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>